## 文华财经函数

### 1.自编策略模型支持的函数
#### 1.1.历史数据引用
| 函数 | 意义 |
|:---------:|:----------|
| AVPRICE | 取得均价(在盘后对于国内三个期货交易所指结算价) |
| SETTLE | 取得结算价(只有在日线周期盘后才能取得当日的结算价)<br>说明：如果用在周期小于'日'的K线上如5分钟K线，一小时k线，每根k线返回的值表示这根k线当日开盘时到这根k线的为止的结算价(均价)<br>如果用在周期大于等于'日'的K线上，返回当根K线结束时间所在日的结算价. |
| CLOSE | 取得收盘价(在盘中指最新价)，也可简写为 C 。 |
| HIGH | 求高价，也可简写为 H 。 |
| LOW | 求最低价，也可简写为L 。 |
| OPEN | 求开盘价，也可简写为O 。 |
| OPI | 取持仓量 |
| REF(X,N) | 引用X在N个周期前的值<br>例:REF(CLOSE,5);表示引用当前周期前第5个周期的收盘价 |
| REFX(X,N) | 引用N个周期后的数据。（N为大于等于1的整数）『未来函数』<br>例：REFX(CLOSE,5);表示引用自当前周期后第5个周期的收盘价 本函数运算量很大，将占用很多的CPU资源，导致行情刷新速度变慢，请谨慎使用! |
| #MPORT | 引用某品种在某个周期上加载了某个指标的数据。<br>用法：#IMPORT [CODE, PERIOD, FORMULA] AS VAR。引用 CODE 所对应的合约 PERIOD 周期下指标 FORMULA 的数据。<br>CODE 文华码，PERIOD 周期，FORMULA 引用指标名，VAR定义变量名<br>注意：<br>1.只能引用 .FML/.XFML文件<br>2.只能引用如下周期：MIN1 MIN3 MIN5 MIN15 MIN30 HOUR1 DAY WEEK MONTH<br>3.只能短周期引用长周期 <br>4.被引用的指标中不能存在引用<br>5.如果不写文华码，默认引用当前合约 |
| MINPRICE | 返回某品种的最小变动价位。<br>用法：MINPRICE(CODE); 返回CODE所对应合约的最小变动价位。<br>CODE 文华码或交易代码。例：MINPRICE('IF1107'); 表示返回IF1007的最小变动价位。<br>注意：某些合约（如橡胶指数）查不到最小变动价位，返回0。 |
| VOL | 求成交量，也可简写为V 。 |


#### 1.2.日内高频数据引用
| 函数 | 意义 |
|:---------:|:----------|
| L2_BID1 | 取秒周期末买1价（K线图）或该笔TICK时刻的买1价（Tick图）。<br>用法：<br>L2_BID1 K线图时返回当前秒周期最后时刻的买1价。TICK图时返回该笔TICK时刻的买1价。 |
| L2_BID2 | 取秒周期末买2价（K线图）或该笔TICK时刻的买2价（Tick图）。<br>用法：<br>L2_BID2 K线图时返回当前秒周期最后时刻的买2价。TICK图时返回该笔TICK时刻的买2价。 |
| L2_BID3 | 取秒周期末买3价（K线图）或该笔TICK时刻的买3价（Tick图）。<br>用法：<br>L2_BID3 K线图时返回当前秒周期最后时刻的买3价。TICK图时返回该笔TICK时刻的买3价。 |
| L2_BID4 | 取秒周期末买4价（K线图）或该笔TICK时刻的买4价（Tick图）。<br>用法：<br>L2_BID4 K线图时返回当前秒周期最后时刻的买4价。TICK图时返回该笔TICK时刻的买4价。 |
| L2_BID5 | 取秒周期末买5价（K线图）或该笔TICK时刻的买5价（Tick图）。<br>用法：<br>L2_BID5 K线图时返回当前秒周期最后时刻的买5价。TICK图时返回该笔TICK时刻的买5价。 |
| L2_ASK1 | 取秒周期末卖1价（K线图）或该笔TICK时刻的卖1价（Tick图）。<br>用法：<br>L2_ASK1 K线图时返回当前秒周期最后时刻的卖1价。TICK图时返回该笔TICK时刻的卖1价。 |
| L2_ASK2 | 取秒周期末卖2价（K线图）或该笔TICK时刻的卖2价（Tick图）。<br>用法：<br>L2_ASK2 K线图时返回当前秒周期最后时刻的卖2价。TICK图时返回该笔TICK时刻的卖2价。 |
| L2_ASK3 | 取秒周期末卖3价（K线图）或该笔TICK时刻的卖3价（Tick图）。<br>用法：<br>L2_ASK3 K线图时返回当前秒周期最后时刻的卖3价。TICK图时返回该笔TICK时刻的卖3价。 |
| L2_ASK4 | 取秒周期末卖4价（K线图）或该笔TICK时刻的卖4价（Tick图）。<br>用法：<br>L2_ASK4 K线图时返回当前秒周期最后时刻的卖4价。TICK图时返回该笔TICK时刻的卖4价。 |
| L2_ASK5 | 取秒周期末卖5价（K线图）或该笔TICK时刻的卖5价（Tick图）。<br>用法：<br>L2_ASK5 K线图时返回当前秒周期最后时刻的卖5价。TICK图时返回该笔TICK时刻的卖5价。 |
| L2_BIDVOL1 | 取秒周期末买1量（K线图）或该笔TICK时刻的买1量（Tick图）。<br>用法：<br>L2_BID1 K线图时返回当前秒周期最后时刻的买1量。TICK图时返回该笔TICK时刻的买1量。 |
| L2_BIDVOL2 | 取秒周期末买2量（K线图）或该笔TICK时刻的买2量（Tick图）。<br>用法：<br>L2_BID2 K线图时返回当前秒周期最后时刻的买2量。TICK图时返回该笔TICK时刻的买2量。 |
| L2_BIDVOL3 | 取秒周期末买3量（K线图）或该笔TICK时刻的买3量（Tick图）。<br>用法：<br>L2_BID3 K线图时返回当前秒周期最后时刻的买3量。TICK图时返回该笔TICK时刻的买3量。 |
| L2_BIDVOL4 | 取秒周期末买4量（K线图）或该笔TICK时刻的买4量（Tick图）。<br>用法：<br>L2_BID4 K线图时返回当前秒周期最后时刻的买4量。TICK图时返回该笔TICK时刻的买4量。 |
| L2_BIDVOL5 | 取秒周期末买5量（K线图）或该笔TICK时刻的买5量（Tick图）。<br>用法：<br>L2_BID5 K线图时返回当前秒周期最后时刻的买5量。TICK图时返回该笔TICK时刻的买5量。 |
| L2_ASKVOL1 | 取秒周期末卖1量（K线图）或该笔TICK时刻的卖1量（Tick图）。<br>用法：<br>L2_ASK1 K线图时返回当前秒周期最后时刻的卖1量。TICK图时返回该笔TICK时刻的卖1量。 |
| L2_ASKVOL2 | 取秒周期末卖2量（K线图）或该笔TICK时刻的卖2量（Tick图）。<br>用法：<br>L2_ASK2 K线图时返回当前秒周期最后时刻的卖2量。TICK图时返回该笔TICK时刻的卖2量。 |
| L2_ASKVOL3 | 取秒周期末卖3量（K线图）或该笔TICK时刻的卖3量（Tick图）。<br>用法：<br>L2_ASK3 K线图时返回当前秒周期最后时刻的卖3量。TICK图时返回该笔TICK时刻的卖3量。 |
| L2_ASKVOL4 | 取秒周期末卖4量（K线图）或该笔TICK时刻的卖4量（Tick图）。<br>用法：<br>L2_ASK4 K线图时返回当前秒周期最后时刻的卖4量。TICK图时返回该笔TICK时刻的卖4量。 |
| L2_ASKVOL5 | 取秒周期末卖5量（K线图）或该笔TICK时刻的卖5量（Tick图）。<br>用法：<br>L2_ASK5 K线图时返回当前秒周期最后时刻的卖5量。TICK图时返回该笔TICK时刻的卖5量。 |
| L2_PRICE | 取Tick图中该笔TICK的成交价。<br>用法：<br>L2_PRICE 返回TICK图中该笔TICK的成交价。 |
| L2_VOLUME | 取TICK图中该笔TICK的成交量。<br>用法：<br>L2_VOLUME 返回TICK图中该笔TICK的成交量。 |
| ASKBIGVOLPRICE | TICK图中该笔Tick 盘口中空头满足大单条件的与最新价的最近价格。<br>用法：<br>ASKBIGVOLPRICE 返回TICK图中该笔Tick 盘口满足大单条件的与最新价的最近价格, 注模型中需调用一次CALVOLPRICELIST函数 |
| BIDBIGVOLPRICE | TICK图中该笔Tick 盘口中多头满足大单条件的与最新价的最近价格。<br>用法：<br>BIDBIGVOLPRICE 返回TICK图中该笔Tick 盘口满足大单条件的与最新价的最近价格, 注模型中需调用一次CALVOLPRICELIST函数 |
| CALVOLPRICELIST | TICK图中初始化盘口大单价格表,主要在BIDBIGVOLPRICE 与ASKBIGVOLPRICE 前使用，提供初始化。<br>用法：<br>CALVOLPRICELIST |
| L2_SETBIGVOL | 设置大单成交手数阈值 <br>用法：<br>L2_SETBIGVOL( nVol ) 成交手数大于nVol的为大单，<br>例：L2_SETBIGVOL( 10 ); // 大于10手的是大单 <br>L2_BKBIGCOUNT; // 查看买开的大单成交次数; |
| L2_BIDVOL | 取秒周期主动买的成交量。<br>用法：<br>L2_BIDVOL 返回当前秒周期主动买的成交量 |
| L2_ASKVOL | 取秒周期主动卖的成交量。<br>用法：<br>L2_ASKVOL 返回当前秒周期主动卖的成交量 |
| L2_BIDBIGCOUNT | 取秒周期主动买的大单成交次数。<br>用法：<br>L2_BIDBIGCOUNT 返回当前秒周期主动买的大单成交次数 |
| L2_ASKBIGCOUNT | 取秒周期主动卖的大单成交次数。<br>用法：<br>L2_ASKBIGCOUNT 返回当前秒周期主动卖的大单成交次数 |
| L2_IDBIGTOTVOL | 取秒周期主动买的大单成交量。<br>用法：<br>L2_BIDBIGTOTVOL 返回当前秒周期主动买的大单成交量 |
| L2_ASKBIGTOTVOL | 取秒周期主动卖的大单成交量。<br>用法：<br>L2_ASKBIGTOTVOL 返回当前秒周期主动卖的大单成交量 |
| L2_BKVOL | 取秒周期买开的成交量。<br>用法：<br>L2_BKVOL 返回当前秒周期买开的成交量 |
| L2_SKVOL | 取秒周期卖开的成交量。<br>用法：<br>L2_SKVOL 返回当前秒周期卖开的成交量 |
| L2_BPVOL | 取秒周期买平的成交量。<br>用法：<br>L2_BPVOL 返回当前秒周期买平的成交量 |
| L2_SPVOL | 取秒周期卖平的成交量。<br>用法：<br>L2_SPVOL 返回当前秒周期卖平的成交量 |
| L2_BKBIGCOUNT | 取秒周期买开的大单成交次数。<br>用法：<br>L2_BKBIGCOUNT 返回当前秒周期买开的大单成交次数 |
| L2_SKBIGCOUNT | 取秒周期卖开的大单成交次数。<br>用法：<br>L2_SKBIGCOUNT 返回当前秒周期卖开的大单成交次数 |
| L2_BPBIGCOUNT | 取秒周期买平的大单成交次数。<br>用法：<br>L2_BPBIGCOUNT 返回当前秒周期买平的大单成交次数 |
| L2_SPBIGCOUNT | 取秒周期卖平的大单成交次数。<br>用法：<br>L2_SPBIGCOUNT 返回当前秒周期卖平的大单成交次数 |
| L2_BKBIGTOTVOL | 取秒周期买开的大单成交量。<br>用法：<br>L2_BKBIGTOTVOL 返回当前秒周期买开的大单成交量 |
| L2_SKBIGTOTVOL | 取秒周期卖开的大单成交量。<br>用法：<br>L2_SKBIGTOTVOL 返回当前秒周期卖开的大单成交量 |
| L2_BPBIGTOTVOL | 取秒周期买平的大单成交量。<br>用法：<br>L2_BPBIGTOTVOL 返回当前秒周期买平的大单成交量 |
| L2_SPBIGTOTVOL | 取秒周期卖平的大单成交量。<br>用法：<br>L2_SPBIGTOTVOL 返回当前秒周期卖平的大单成交量 |


#### 1.3.行情数据引用
| 函数 | 意义 |
|:---------:|:----------|
| GETPRICE(N) | 根据文华码取出某一品种的最新价。<br>例：GETPRICE(1209);返回文华码为1209的合约品种的最新价。 |


#### 1.4.金融统计
| 函数 | 意义 |
|:---------:|:----------|
| BACKSET(X,N) | 若X条件成立,则将当前位置到N周期前的数值设为1。『未来函数』<br>例：BACKSET(CLOSE>OPEN,3);表示当K线收阳时，自当前位置到3周期前的数值设为1 |
| BARSLAST(X) | 求上一次条件成立到当前的周期数。 |
| COUNT(X,N) | 表示统计在N周期内满足X条件的周期数。如果N为0则表示从已申请到的数据的第一天开始算起。<br>例：WR:=-100*(HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N)); COUNT(WR>80,5);表示统计在5个周期内满足WR>80的次数 |
| DMA(X,A) | 返回X的动态移动平均，其中A为常数，并且必须介于0及1之间。<br>计算方法：DMA(N)=DMA(N-1)*(1-A)+X(N)*A 其中DMA(N-1)为第(N-1)天的DMA值。 |
| EMA(X,N) | 表示求X在N周期内的平滑移动平均。（指数加权）<br>计算方法：EMA(X,N)=[2*X+(N-1)*EMA(X,(N-1))]/(N+1) 其中EMA(X,(N-1))为第(N-1)天的EMA值 |
| EMA2(X,N) | 表示求X在N周期内的加权平均。（线性加权）<br>计算方法：EMA2(X,N)=(N*X0+(N-1)*X1+(N-2)*X2+...+1*XN-1)/(N+(N-1)+(N-2)+...+1),X0表示本周期值，X1表示上一周期值... |
| HHV(X,N) | 得到X在N周期内的最高值，如果N＝0，则从本地数据的第一个有效周期开始算起。<br>例：HHV(HIGH,13);求13个周期内的最高价的最大值。 |
| HHVBARS(X,N) | 得到X在N周期内的最高值位置到当前的周期数。如果N=0，则从本地数据的第一个有效周期开始算起。<br>例：HHVBARS(VOL,0); 求历史成交量最大的周期到当前的周期数 |
| LLV(X,N) | 得到X在N周期内的最小值，如果N=0，则从本地数据的第一个有效周期开始算起。<br>例：LLV(LOW,25);表示求25个周期内最低价的最小值 |
| LLVBARS(X,N) | 得到X在N周期内的最小值的位置到当前的周期数。如果N=0则从本地数据的第一个有效周期开始算起。<br>例：LLVBARS(VOL,0); 求历史成交量最小的周期到当前的周期数 |
| MA(X,N) | 求X在N周期内的简单移动平均。<br>计算方法：MA=(A1+A2+A3+A4+A5)/5 求A在5个周期内的简单移动平均 |
| SLOPE(X,N) | 求线型回归的斜率。<br>用法：<br>SLOPE(X,N)得到X的N周期的线型回归的斜率。<br>例:SLOPE(CLOSE,5);表示求收盘价5个周期线性回归线的斜率 |
| ZIGZAG(X,P,N) | 之字转向,当X变化量超过P时转向,当N取1,P为百分比数;当N取0,P为价位差值绝对值。『未来函数』<br>例：ZIGZAG(HIGH,10,1);表示最高价的10%的之字转向<br>ZIGZAG(MA(HIGH,34),100,0);表示34个周期内最高价均线的100个价位的之字转向 |
| PEAK(X,P,M,N) | 取得ZIGZAG前M个波峰的值。其中X为数据，P为转折值（如果N为1，这个值为百分比数，否则为价位差值绝对值），M为大于等于1的整数。『未来函数』<br>例：PEAK(HIGH,10,1,1);表示最高价的10%的之字转向的上一个波峰的数值;<br>PEAK(MA(HIGH,34),100,1,0);表示34个周期内最高价均线的100个价位的之字转向的上一个波峰的数值 |
| PEAKBARS(X,P,M,N) | 取得ZIGZAG前M个波峰到当前周期的周期数。其中X为数据，P为转折值（如果N为1，这个值为百分比数，否则为价位差值绝对值），M为大于等于1的整数。『未来函数』<br>例：PEAKBARS(HIGH,10,1,1);表示最高价的10%的之字转向的上一个波峰到当前的周期数<br>PEAKBARS(MA(HIGH,34),100,1,0);表示34个周期内最高价均线的100个价位的之字转向的上一个波峰到当前的周期数 |
| TROUGH(X,P,M,N) | 取得ZIGZAG前M个波谷的值。其中X为数据，P为转折值（如果N为1，这个值为百分比数，否则为价位差值绝对值），M为大于等于1的整数。『未来函数』<br>例：TROUGH(LOW,10,1,1);表示最低价的10%的之字转向的上一个波谷的数值<br>TROUGH (MA(LOW,34),100,1,0);表示34个周期内最低价均线的100个价位的之字转向的上一个波谷的数值 |
| TROUGHBARS(X,P,M,N) | 取得ZIGZAG前M个波谷到当前周期的周期数。其中X为数据，P为转折值（如果N为1，这个值为百分比数，否则为价位差值绝对值），M为大于等于1的整数。『未来函数』<br>TROUGH(LOW,10,1,1);表示最低价的10%的之字转向的上一个波谷到当前的周期数<br>TROUGH (MA(LOW,34),100,1,0);表示34个周期内最低价均线的100个价位的之字转向的上一个波谷到当前的周期数 |
| SAR(N,Step,Max | 得到抛物转向值。N为计算周期,Step为步长,Max为极值。（系统函数，计算步骤后台自动完成）<br>例：SAR(17,0.03,0.3);表示计算17个周期抛物转向，步长为3%，极限值为30% |
| SMA(X,N,M) | 得到X在N个周期内的移动平均，M为权重（M为常数）。<br>计算方法：SMA(N)=SMA(N-1)*(N-M)/N+X(N)*M/N |
| STD(X,N) | 求标准差。<br>用法：<br>STD(X,N)求X在N个周期内的标准差。 |
| STDP(X,N) | 求总体标准差。<br>用法：<br>STDP(X,N)为X的N日总体标准差。 |
| SUM(X,N) | 得到X在N周期内的总和，如果N=0，则从第一个有效周期开始算起。<br>例: SUM(VOL,10);表示统计10周期内的成交量总和 |
| SUMBARS(X,A) | 得到X向前累加直到大于A时的周期数。 |
| TRMA(X,N) | 求X在N周期内的三角移动平均。 |
| TSMA(X,N) | 求X在N周期内的时间序列移动平均。<br>计算方法：TSMA(X,N)= FOCAST(X,N)+SLOPE(X,N) |


#### 1.5.数理统计
| 函数 | 意义 |
|:---------:|:----------|
| AVEDEV(X,N) | 求X在N周期内的平均绝对偏差 |
| DEVSQ(XN) | 数据偏差平方和。 |
| FORCAST(X,N) | 得到X的N周期线性回归预测值。<br>例:FORCAST(CLOSE,5);表示求5周期线性回归预测 |
| VAR(X,N) | 得到X在N周期内的样本方差 |
| VARP(X,N) | 得到X在N周期内的总体样本方差 |
| 数理统计举例说明： | 设一个数列，数列中数据的总个数为N，以今天（2005-10-14）五天内的A0605收盘价为例，N就为5。数列的内容为：｛2766，2805，2814，2886，2885｝。<br>1、算术平均值MA(CLOSE,5)：数据总和除以总个数N。 (2766+2805+2814+2886+2885)/5=2831.20。 可以用公式MA(CLOSE,5),从今天的值上看出。<br>2、偏差：每个数据，减去算术平均值的结果。 2766-2831.20=-65.2， 2805-2831.20=-26.2, 2814-2831.20=-17.2, 2886-2831.20=54.8, 2885-2831.20=53.8, 各偏差相加，应该是等于0的。<br>3、平均绝对偏差AVEDEV(X,N)：将偏差的绝对值相加，除以总个数N。 (65.2+26.2+17.2+54.8+53.8)/5=43.44 <br>4、数据偏差平方和DEVSQ(X,N)：将偏差的平方相加。 (-65.2)2+ (-26.2)2+ (-17.2)2+ (54.8)2+ (53.8)2=11130.80 <br>5、总体样本方差VARP(X,N)：将偏差的平方相加，总和除以总个数N。用公式可以这样算： (-65.2)2+ (-26.2)2+ (-17.2)2+ (54.8)2+ (53.8)2/5=2226.16 <br>6、样本方差VAR(X,N)：是总体方差的N/(N-1)倍。 2226.16*5/(5-1)=2782.70 估算样本方差，总比总体样本方差大一点，当N够大时，两者趋于相等。 |


#### 1.6.逻辑判断
| 函数 | 意义 |
|:---------:|:----------|
| BETWEEN(A,B,C) | 判断条件“A位于B及C之间”是否成立，如果条件成立则返回1 (yes),否则返回0 (no)。<br>例：BETWEEN(CLOSE,MA5,MA40); 表示收盘价介于5日均线与40日均线之间。 |
| CROSS(X,Y) | 表示X上穿Y。<br>例：CROSS(CLOSE,MA(CLOSE,5));表示收盘线从下方向上穿过5日均线 |
| CROSS2(A,B) | 两条线交叉。<br>用法:<br>CROSS2(A,B)表示当A从下方向上穿过B两次时返回1(Yes)，否则返回0(No)<br>例：CROSS2(CLOSE,MA(CLOSE,5));表示收盘线从下方向上穿过5日均线两次 |
| FILTER(COND,N) | 过滤连续出现的信号。<br>用法：<br>FILTER(COND,N) 当COND条件成立时，将其后N周期内的数据置为0。<br>例：FILTER(CLOSE>OPEN,3) 查找阳线，3天内再次出现的阳线不被记录在内<br>注：不能与BKPRICE,BARSBK,SKPRICE,BARSSK一起使用 |
| EXIST(COND,N) | 判断N个周期内是否有满足条件COND的情况发生。<br>例：EXIST(CLOSE>REF(HIGH,1),10);表示10个周期中是否存在收盘价大于前一个周期的最高价 |
| EVERY(COND,N) | 判断过去N个周期内是否一直满足条件COND。<br>例：EVERY(CLOSE>OPEN,5);表示5个周期内一直是阳线 |
| LAST(COND,N1,N2) | 判断过去N1到N2周期内是否一直满足条件COND。<br>例：LAST(CLOSE>OPEN,10,5);表示从过去第10个周期到第5个周期内一直是阳线 |
| LONGCROS(A,B,N) | 如果A在前N个周期内都小于B，本周期上穿B，则返回1。否则返回0。<br>例：LONGCROSS(CLOSE,MA(CLOSE,10),20);表示收盘线在10日均线之下持续20周期后从下向上穿过10日均线 |
| NOFILTER | 交易模型买卖指令信号过滤函数。（仅适用于交易模型的过滤）<br>交易模型公式后加“NOFILTER;”是指不需要过滤，出现任何交易指令都会执行。公式后不加“NOFILTER;”是指当连续出现同方向的交易指令时，系统只显示出第一个交易指令，其他交易指令自动被过滤。 |
| IFELE(C,A,B) | 如果条件C成立则取A值,否则取B值<br>例：A:=IFELSE(MA5>MA10,CROSS(DIFF,DEA),IFELSE(CROSS(D,K),2,0));当MA5>MA10时，取是否满足DIFF上穿DEA，否则(MA5不大于MA10)，当K,D死叉时，令A赋值为2，若上述条件都不满足，A赋值为0<br>A=1,BPK;//当MA5>MA10，以DIFF上穿DEA作为开多仓条件<br>A=2,SPK;//当MA5不大于MA10，以K D死叉作为开空仓条件 |
| ISDOWN | 判断该周期是否收阴。 |
| SEQUAL | 判断该周期是否平盘。 |
| ISUP | 判断该周期是否收阳。 |
| ISLASTBAR | 判断当前周期是否为最后一根K线。 |
| VALUEWHEN(COND,DATA) | 当条件COND满足时，取当时的DATA的值，否则取得前面一个满足条件COND的值。<br>例：VALUEWHEN(HIGH>REF(HIGH,5),HIGH);表示当前最高价大于前五个周期最高价的最大值时返回当前最高价。 |


#### 1.7.数学运算
| 函数 | 意义 |
|:---------:|:----------|
| ABS(X) | 求X的绝对值<br>例：ABS(SAR(17,0.03,0.3));返回抛物转向SAR(17,0.03,0.3)的绝对值。 |
| ACOS(X) | 求X的反余弦值 |
| ASIN(X) | 求X的反正弦值 |
| ATAN(X) | 求X的反正切值 |
| COS(X) | 返回X的余弦值 |
| EXP(X) | 返回e的X次幂 |
| CUBE(X) | 返回X的三次方。 |
| CEILING(X) | 向上舍入，返回沿X数值增大方向最接近的整数。 |
| FLOOR(X) | 向下舍入，返回沿X数值减小方向最接近的整数。 |
| INTPART(X) | 取X的整数部分，返回沿X绝对值减小方向最接近的整数。 |
| LN(X) | 得到X的自然对数，以e为底的对数。<br>例：LN(OPEN);求开盘价的自然对数。 |
| LOG(X) | 得到X的常用对数，取得X的以10为底的对数。<br>例：LOG(OPEN);求开盘价的以10为底的对数。 |
| MAX(A,B) | 求A,B中的较大者。<br>例：MAX(CLOSE-OPEN,0);表示若收盘价大于开盘价返回它们的差值，否则返回0。 |
| MIN(A,B) | 求A,B中的较小者。<br>例：MIN(OPEN,CLOSE);返回开盘价和收盘价中的较小值。 |
| MOD(A,B) | 返回A对B得到模。<br>例：MOD(CLOSE,500);收盘价除以500所得余数 |
| NOT(X) | 当X为0时返回1,否则返回0。<br>例：NOT(TIME=090530);表示该周期对应的时间不是9:05:30AM。 |
| POW(A,B) | 得到A的B次幂。<br>例：POW(CLOSE,2);求得收盘价的2次方。 |
| REVERSE(X) | 取反，返回符号相反的数值。<br>例：REVERSE(LOW);返回-LOW。 |
| RANGE(A,B,C) | 表示A大于B同时小于C时返回1，否则返回0 |
| SGN(X) | 得到X的符号，如果X>0则返回1,如果X<0则返回－1，否则返回0。 |
| SIN(X) | 得到X的正弦值。 |
| SQRT(X) | 得到X的平方根。<br>例：SQRT(CLOSE);收盘价的平方根。 |
| SQUARE(X) | 得到X的平方。<br>例：SQUARE(CLOSE);收盘价的平方。 |
| TAN(X) | 得到X的正切值。 |


#### 1.8.时间函数
| 函数 | 意义 |
|:---------:|:----------|
| BARPOS | 取得当前K线的位置。 |
| DATE | 取得当前周期的日数（700101-341231）。 |
| DAY | 取得当前周期的日数（1-31）。 |
| HOUR | 取得当前周期的小时数（0-23）。 |
| MINUTE | 取得当前周期的分钟数（0-59）。 |
| MONTH | 取得当前周期的月数（1-12）。 |
| TIME | 取得当前周期的时间数（0-2359），秒级周期返回值范围为：0-235959。 |
| WEEKDAY | 取得当前周期的星期数（0-6）。 |
| YEAR | 取得当前周期的年数（1970-2034）。 |


#### 1.9.绘图
| 函数 | 意义 |
|:---------:|:----------|
| BACKGROUNDSTYLE(i) | 设置背景的样式。<br>用法：<br>BACKGROUNDSTYLE(i)设置背景的样式。<br>i = 0 或 1。 |
| DRAWLINE(C1,P1,C2,P2,COLOR) | 当条件C1及C2均满足时，从P1画直线到P2，颜色为COLOR。<br>例：DRAWLINE(MA18< CLOSE,OPEN,MA5 >CLOSE,CLOSE,COLORCYAN); 表示当收盘价大于18日均线并且小于5日均线时，从开盘价画青色直线到收盘价。 |
| DRAWTEXT(C,P,TEXT) | 表示当条件C满足时在P上写TEXT文字。<br>例：DRAWTEXT(CLOSE< OPEN&&REF(CLOSE,1)< REF(OPEN,1) &&REF(VOL,1)*1.1< VOL,LOW,'注'); 表示连续两日收阴并且成交量比前一日至少多10%时，在最低价上写“注”字。 |
| DRAWSL(COND,DATA,SLOPE,LE,EXPAND, COLOR) | 画斜线，当条件COND满足时，从DATA开始以每个周期相差SLOPE个点的斜率画斜线，划线长度为LEN个周期，EXPAND为线段的延长方式（0：不延伸；1:向左延伸；2:向右延伸；3：双向延伸）。<br>例：DRAWSL(LOW=LLV(LOW,50),LOW,5,3,2,COLORRED); 表示当前最低价等于50周期内的最小值时，从当前最小值开始以每隔5个点的斜率画长度为3个周期向右延伸的斜线，颜色为红色 |
| DRAWNUMBER (COND,DATA,NUMBER,PRECSION,COLOR) | 画数字。当条件COND满足时，在DATA位置写数字NUMBER（为数组），精度为PRECISION（小数点后有几位数字）。<br>例：DRAWNUMBER(CLOSE/OPEN>1.08,HIGH,(CLOSE-OPEN)/OPEN*100,2,COLORRED); 表示当日涨幅大于8%时在最高价位置显示涨幅(相对开盘价的百分比)。 |
| FILLRGN (COND,DATA1,DATA2,COLOR) | 填充区域，当条件COND满足时，填充DATA1及DATA2包围的区域。<br>例：FILLRGN(MA5>MA10,MA5,MA10,COLORRED); 表示MA5>MA10时以红色填充MA5和MA10之间的区域。 |
| PLAYSOUND(COND, 'N') | 当条件满足时，播放自定义声音'N'(自定义声音在插入声音文件中设置，最多可以设置10个)。<br>例：PLAYSOUND(CLOSE>OPEN,'A');表示CLOSE>OPEN时播放自定义声音'A'。 |
| POLYLINE (COND,DATA,COLOR) | 画折线，当条件COND满足时，连接各个DATA点。<br>例：POLYLINE(CLOSE>=HHV(CLOSE,100),CLOSE,COLORRED); 表示在收盘价创100天新高点之间画折线。 |
| PARTLINE (COND,DATA,COLOR) | 同POLYLINE。<br>例：PARTLINE(HIGH>REF(HIGH,1),HIGH,COLORRED); 表示当期最高价大于前期最高价用红色绘制最高价连线线段。 |
| STICKLINE (C,P1,P2,Color,Empty) | 如果条件C满足时，从P1到P2画柱线，颜色为Color,如果Empty取1，则为空心柱；如果Empty取0，则为实心柱。<br>例：STICKLINE(OPEN-CLOSE>0,OPEN,CLOSE,COLORCYAN,0); 表示当开盘价大于收盘价时，从开盘价到收盘价画青色的实心柱，即K线阴线的实体部分。 |
| VERTLINE (COND,COLOR) | 画垂直线，当条件COND满足时，画垂直线。<br>例：VERTLINE(HIGH>=HHV(HIGH,30),COLORRED); 表示在价格创30天新高时画垂直线。 |
| RGB(R,G,B) | 自定义颜色函数。R,G,B的数值范围都在0~255之间，例：RGB(225,225,225)表示白色 |
| COLORSTICK | 画彩色柱线 |
| VOLUMESTICK | 画成交量线 |
| BAMBOOLINE | 画竹线 |
| CIRCLEDOT | 画圆 |
| OPISTICK | 画持仓量柱线 |


#### 1.10.颜色常数
| 函数 | 意义 |
|:---------:|:----------|
| COLORRED | 红色 |
| COLORGREEN | 绿色 |
| COLORBLUE | 蓝色 |
| COLORMAGENTA | 红紫色 |
| COLORYELLOW | 黄色 |
| COLORLIGHTGREY | 浅灰色 |
| COLORLIGHTRED | 浅红色 |
| COLORLIGHTGREEN | 浅绿色 |
| COLORLIGHTBLUE | 浅蓝色 |
| COLORBLACK | 黑色 |
| COLORWHITE | 白色 |
| COLORCYAN | 青色 |


#### 1.11.头寸函数
| 函数 | 意义 |
|:---------:|:----------|
| AUTOFILTER | 对模型的所有信号按照先买后卖，先开后平的顺序过滤。<br>用法：AUTOFILTER产生的指令将按照如下规则过滤：<br>1.连续的同方向指令只有第一个有效，其他的将被过滤；<br>2.交易指令必须配对出现（例如：前面已经有了买开指令，则后面只允许出现卖平指令，其他的指令都被滤掉。这也就意味着，第一个指令只能是买开或者卖开指令，其他的都被过滤）； 例：<br>CLOSE>OPEN,BPK;<br>CLOSE<OPEN,SPK;<br>AUTOFILTER;<br>注意如果使用自动过滤函数建议就不要在代码中再使用其它的语句进行过滤的编写。 |
| BARSBK | 上一次买开信号位置<br>用法：<br>BARSBK返回上一次买开仓距离当前k线的k线数。 |
| BARSSK | 上一次卖开信号位置<br>用法：<br>BARSSK返回上一次卖开仓距离当前k线的k线数。 |
| ISLASTBK | 判断上一个交易信号是否是BK。<br>用法：<br>ISLASTBK 如果上一个交易信号是BK则返回1（Yes），否则返回0（No） |
| ISLASTSK | 判断上一个交易信号是否是SK。<br>用法：<br>ISLASTSK 如果上一个交易信号是SK则返回1（Yes），否则返回0（No） |
| ISLASTBP | 判断上一个交易信号是否是BP。<br>用法：<br>ISLASTBP 如果上一个交易信号是BP则返回1（Yes），否则返回0（No） |
| ISLASTSP | 判断上一个交易信号是否是SP。<br>用法：<br>ISLASTSP 如果上一个交易信号是SP则返回1（Yes），否则返回0（No） |
| ISLASTBPK | 判断上一个交易信号是否是BPK。<br>用法：<br>ISLASTBPK 如果上一个交易信号是BPK则返回1（Yes），否则返回0（No） |
| ISLASTSPK | 判断上一个交易信号是否是SPK。<br>用法：<br>ISLASTSPK 如果上一个交易信号是SPK则返回1（Yes），否则返回0（No） |
| FEE | 合约手续费<br>用法：<br>FEE返回当前合约的手续费（用户启动模组时设置的）。<br>注意不能与未来函数同时使用如ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,TROUGH,TROUGHBARS,REFX等 本函数运算量很大，将占用很多的CPU资源，导致行情刷新速度变慢，请谨慎使用! |
| ISLASTBUYLONG | 判断上一个信号是否是BUYLONG<br>用法：<br>ISLASTBUYLONG 如果上一个交易信号是BUYLONG则返回1（Yes），否则返回0（No） |
| ISLASTSELLSHORT | 判断上一个信号是否是SELLSHORT<br>用法：<br>ISLASTSELLSHORT 如果上一个交易信号是SELLSHORT则返回1（Yes），否则返回0（No） |
| ISLASTEXITLONG | 判断上一个信号是否是EXITLONG<br>用法：<br>ISLASTEXITLONG 如果上一个交易信号是EXITLONG则返回1（Yes），否则返回0（No） |
| ISLASTEXITSHORT | 判断上一个信号是否是EXITSHORT<br>用法：<br>ISLASTEXITSHORT 如果上一个交易信号是EXITSHORT则返回1（Yes），否则返回0（No） |
| BKPRICE | 买开信号位置的买开信号价位。<br>用法：<br>BKPRICE返回最近一次模型买开位置的买开信号价位。<br>例如:<br>BKPRICE-CLOSE>60 && BKPRICE>0, SP;//如果买开价位比当前价位高出60,且买开价位存在，卖平仓<br>请注意当模型存在连续多个开仓信号(加仓)的情况下，该函数返回的是最后一次开仓信号的价格,而不是开仓均价。<br>注：BKPRICE 只在加载之后的K线上才返回信号价位，历史K线信号由于无信号价位会返回0，使用时请注意判断BKPRICE>0。效果测试中该函数返回信号位置的收盘价 |
| SKPRICE | 卖开信号位置的卖开信号价位<br>用法：<br>SKPRICE返回最近一次模型卖开位置的卖开信号价位。<br>例如:<br>CLOSE-SKPRICE>60 && SKPRICE>0, BP;//如果当前价位高出卖开价位60， 且卖开价位存在, 买平仓<br>请注意当模型存在连续多个开仓信号(加仓)的情况下，该函数返回的是最后一次开仓信号的价格,而不是开仓均价。<br>注：SKPRICE 只在加载之后的K线上才返回信号价位，历史K线信号由于无<br>信号价位会返回0，使用时请注意判断SKPRICE>0。效果测试中该函数返回信号位置的收盘价 |
| BARSBP | 上一次买平信号位置<br>用法：<br>BARSBP返回上一次买平仓距离当前k线的k线数。 |
| BARSSP | 上一次卖平信号位置<br>用法：<br>BARSSP返回上一次卖平仓距离当前k线的k线数。 |
| LASTSIG | 判断上一次交易的信号<br>用法：<br>LASTSIG返回上一次交易的信号。<br>注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,<br>TROUGH,TROUGHBARS,REFX等可能会导致误差。 |
| MONEY | 虚拟资金余额<br>用法：<br>MONEY返回虚拟资金余额。<br>注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,<br>TROUGH,TROUGHBARS,REFX等可能会导致误差。 |
| BUYVOL | 模型虚拟多头持仓<br>用法：<br>BUYVOL返回模型虚拟多头持仓。<br>注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,<br>TROUGH,TROUGHBARS,REFX等可能会导致误差。 |
| SELLVOL | 模型虚拟空头持仓<br>用法：<br>SELLVOL返回模型虚拟空头持仓。<br>注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,<br>TROUGH,TROUGHBARS,REFX等可能会导致误差。 |
| MARGIN | 合约保证金<br>用法：<br>MARGIN返回当前合约的保证金比率（用户启动模组时设置的）。<br>注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,<br>TROUGH,TROUGHBARS,REFX等可能会导致误差。 |
| VOLMARGIN | 模型虚拟空头持仓<br>用法：<br>VOLMARGIN计算当前的持仓保证金。<br>注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,<br>TROUGH,TROUGHBARS,REFX等可能会导致误差。 |
| MONEYRATIO | 资金使用率<br>用法：<br>MONEYRATIO返回当前的虚拟资金的使用率。<br>注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,<br>TROUGH,TROUGHBARS,REFX等可能会导致误差。 |
| MONEYTOT | 虚拟总资金<br>用法：<br>MONEYTOT返回当前虚拟总资金（虚拟资金余额+持仓保证金）。<br>注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,<br>TROUGH,TROUGHBARS,REFX等可能会导致误差。 |
| PROFIT | 虚拟逐笔浮盈<br>用法：<br>PROFIT返回当前的虚拟逐笔浮动盈亏。<br>注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,<br>TROUGH,TROUGHBARS,REFX等可能会导致误差。 |
| SETDEALPERCENT | 设置下单的虚拟资金使用比例<br>用法：<br>SETDEALPERCENT(fPercent)表示每次按资金的fPercent（范围1~100）下单。<br>例子：SETDEALPERCENT(20); //每次按资金比例的%20下单<br>注：应该与AUTOFILTER函数同时使用 |


### 2.自编下单组件支持的函数
#### 2.1.引用数据函数
| 函数 | 意义 |
|:---------:|:----------|
| AvPrice(Code) | 某合约当前均价。<br>用法：<br>AvPrice(Code)返回合约Code的当前均价，Code为某合约的合约代码<br>例：VAR avprice;//定义一个变量avpriceavprice=AvPrice("m1109"); //price的值为合约m1109的当前均价 |
| High(Code) | 某合约当前最高价。<br>用法：<br>High(Code)返回合约Code的当前最高价，Code为某合约的合约代码<br>例：<br>VAR high;//定义一个变量high<br>high=High("m1109"); //high的值为合约m1109的当前最高价 |
| Low(Code) | 某合约当前最低价。<br>用法：<br>Low(Code)返回合约Code的当前最低价，Code为某合约的合约代码<br>例：<br>VAR low;//定义一个变量low<br>low=Low("m1109"); //low的值为合约m1109的当前最低价 |
| Position(Code,strContent) | 某合约的盘口数据。<br>用法：<br>Position(Code,strContent) 返回某合约某种盘口数据Code<br>为某合约的合约代码(字符串), strContent为所要取得内容,<br>可选以下内容<br>"bid1","bid2","bid3","bid4","bid5",<br>"ask1","ask2","ask3","ask4","ask5",<br>"bidvol1","bidvol2","bidvol3","bidvol4","bidvol5",<br>"askvol1","askvol2","askvol3","askvol4","askvol5",<br>分别表示买1-买5 卖1-卖5 买1量-买5量 卖1量-卖5量。<br>例：<br>VAR bid1;<br>bid1=Position("m1109","bid1");//bid1为豆粕1009的当前买1价 |
| Price(Code) | 某合约当前价格。<br>用法：<br>Price(Code)返回合约Code的当前价格，Code为某合约的合约代码<br>例：<br>VAR price;//定义一个变量price<br>price=Price("m1109"); //price的值为合约m1109的当前价格 |
| Volume(Code) | 某合约当前成交量。<br>用法：<br>Volume(Code)返回合约Code的当前成交量，Code为某合约的合约代码<br>例：<br>VAR volume;//定义一个变量volume<br>volume=Volume("m1109"); //volume的值为合约m1109的当前成交量 |


#### 2.2.逻辑判断函数
| 函数 | 意义 |
|:---------:|:----------|
| SamePeriod(Code,PeriodStr,T1,T2) | 判断两个时间是否是同一个周期。<br>用法：<br>SamePeriod(Code,PeriodStr,T1,T2)如果T1,T2是同一个周期返回1，<br>否则返回0,Code:合约的合约代码，PeriodStr可以取以下值的其中之一：<br>"min1","min3","min5","min10","min15","min30","1hour","3hour",<br>"8hour","1day","week","month"，T1和T2是以总秒数表示的时间<br>例：<br>IF(SamePeriod("m1109","min10",LastOrderTime(),Time("09:00:00"))合约为m1109，周期为10分钟情况下，如果最后一次下单时间与09:00:00在同一个周期内 |


#### 2.3.辅助函数 
| 函数 | 意义 |
|:---------:|:----------|
| CurrentTime() | 当前时间。<br>用法：<br>CurrentTime()返回当前时间<br>例：<br>VAR CurTime; <br>CurTime=CurrentTime(); //定义一个变量CurTime,CurTime的值为当前时间。注意返回值是1970年1月1日至今的总秒数 |
| DateToStr(nSec) | 日期转换为字符串。<br>用法：<br>DateToStr(nSec)把整形数值表示的时间nSec转换为字符串，nSec为时间的总秒数，返回的字符串格式为：YY:MM:DD<br>例：<br>MessageOut(DateToStr(CurrentTime() ) ); //输出当前日期 |
| Exit() | 退出程序。<br>用法：<br>Exit()退出程序。<br>例：Exit(); 退出程序。当组件设置为循环时，遇到Exit将停止循环，请谨慎使用。当组件未设置为循环执行时，应该使用RETURN语句退出。 |
| Itoa(Value) | 数字转换为字符。<br>用法：<br>Itoa(Value)将Value转换成字符串，Value的为整形数值<br>例：<br>VAR str; str="数字"+Itoa(5); //str的值为"数字5" |
| MessageOut(Content) | 输出内容。<br>用法：MessageOut(Content),输出Content的内容。注意：Content可以是字符串也可以是数字 |
| ReadGlobal(strName) | 返回已注册的整形变量的值<br>用法：ReadGlobal(strName);返回注册的strName的值,strName为已注册的整形变量的注册名称(字符串)。如果strName未被注册过，返回0<br>例：<br>WriteGlabal("limit",20);<br>VAR limitValue;<br>limitValue=ReadGlobal("limit");limitValue的值为20。 |
| ReadGlobalF(strNameF) | 返回已注册的浮点型变量的值<br>用法：ReadGlobalF(strNameF);返回注册的strNameF的值,strNameF为已注册的浮点型变量的注册名称(字符串)，如果strNameF未被注册过，返回0.0f<br>例：<br>WriteGlabalF("Rate",0.5);<br>VAR fRate;<br>fRate=ReadGlobal(Rate);fRate的值为0.5。 |
| ReadGlobalStr(NameStr) | 返回已注册的字符串变量的值<br>用法：ReadGlobalStr(NameStr);返回注册的NameStr的值,NameStr为已注册的字符串变量的注册名称。如果NameStr未被注册过，返回(空字符串)<br>例：<br>WriteGlabalStr("showStr","上升");<br>VAR str;<br>str=ReadGlobal(showStr);//str的值为"上升"。 |
| Time(strTime) | 转换字符串为时间。<br>用法：<br>Time(strTime) 转换字符串strTime为时间(以总秒数表示)，strTime的格式应为HH:MM:SS，其中0<=HH<24,0<=MM<60,0<=SS<60,如果不满足此条件，返回0<br>例：<br>time:Time("09:15:00") |
| TimeToStr(nSec) | 时间转换为字符串。<br>用法：<br>TimeToStr(nSec) 把整形数值表示的时间nSec转换为字符串，nSec为时间的总秒数，返回的字符串格式为：HH:MM:SS<br>例：<br>MessageOut(TimeToStr(CurrentTime())),输出当前时间 |
| WriteGlabal(Name,Value) | 注册一个整形变量。<br>用法：<br>WriteGlabal(Name,Value)。Name为整形变量的注册名称(字符串)，Value为整形变量的值<br>例：<br>WriteGlabal("Period",5) 注册一个整形变量,注册名称为"Period"，值为5。 |
| WriteGlabal(NameF,ValueF) | 注册一个浮点形变量<br>用法：<br>WriteGlabal(NameF,ValueF)。NameF为浮点形变量的注册名称(字符串)，ValueF为浮点形变量的值<br>例：<br>WriteGlabalF("Rate",0.5) 注册一个浮点形变量，注册名称为"Rate"，值为0.5。 |
| WriteGlabalStr(NameStr,ValueStr) | 注册一个字符串变量<br>用法：WriteGlabalStr(NameStr,ValueStr)。NameStr为字符串变量的注册名称(字符串)，ValueStr为字符串变量的值<br>例：<br>WriteGlabalStr("showStr","上升") 注册一个字符串变量,注册名称为"showStr"，值为"上升"。 |


#### 2.4.数学运算函数 
| 函数 | 意义 |
|:---------:|:----------|
| ABS(Value) | 取整形绝对值。<br>用法：<br>ABS(Value)返回Value的绝对值，Value是整形值<br>例：<br>VAR X;<br>X=ABS(5);//X的值为5 |
| ABSF(ValueF) | 取浮点型的绝对值。<br>用法：<br>ABSF(ValueF)返回ValueF的绝对值，ValueF是浮点值<br>例：<br>VAR X; <br>X=ABSF(-1.5); //X的值为1.5 |


#### 2.5.模型相关函数 
| 函数 | 意义 |
|:---------:|:----------|
| F_BuyPosition() | 模型某合约多头持仓。<br>用法：<br>F_BuyPosition()返回模型的多头持仓<br>例： <br>VAR fmlBVol; <br>fmlBVol=F_BuyPosition(); //定义一个变量fmlBVol，fmlBVol为模型的多头持仓。 |
| F_SellPosition() | 模型某合约空头持仓。<br>用法：<br>F_SellPosition()返回模型的空头持仓<br>例：<br>VAR fMLSVol;<br>fmlSVol=F_SellPosition(); 定义一个变量fmlSVol，fmlSVol为模型的空头持仓。 |
| F_BuyAvgPrice() | 模型某合约多头持仓成本价。<br>用法：<br>F_BuyAvgPrice()返回模型多头持仓成本价<br>例：<br>VAR price;<br>price=F_BuyAvgPrice(); 定义一个变量price,price的值为值为模型多头持仓成本价 |
| F_SellAvgPrice() | 模型某合约空头持仓成本价。<br>用法：<br>F_SellAvgPrice()返回模型空头持仓成本价<br>例：<br>VAR price;<br>price=F_SellAvgPrice() 定义一个变量price,price的值为模型空头持仓成本价 |
| F_DealCode() | 取得当前模型的合约编码。<br>用法：<br>F_DealCode()返回模型所加载K图表的合约的合约编码(字符串)<br>例：<br>VAR DealCode;<br>DealCode=F_DealCode(); //变量DealCode的内容为模型当前合约的合约编码. |
| F_Period() | 取得当前模型的周期。<br>用法：<br>F_Period() 返回当前模型的周期(字符串)<br>例：<br>VAR period;<br>period=F_Period(); //变量period的内容为当前模型所使用的周期. |
| F_FreshSig() | 刷新当前信号。<br>用法：<br>F_FreshSig() 取一个新信号(如果模型已经发出了多个信号，取最早发出的信号，信号消失也是一种信号)返回1表示取到新信号，返回0表示失败即已经没有新信号可取。取到新信号以后可以配合 F_Sig, F_SigVol, F_SigValid, F_SigTime, F_SigPos使用<br>例：<br>IF(F_FreshSig()) //如果取得了新的信号 |
| F_Sig() | 取当前的信号(BK、SK、BP、SP、PK、SPK)。<br>用法：<br>F_Sig() 返回当前的信号是什么类型(BK、SK、BP、SP、BPK、SPK)例：<br>IF(F_Sig()==BPK && F_SigValid()==1) //如果信号是BPK 且不是信号消失状态 |
| F_SigVol() | 取当前信号的手数。<br>用法：<br>F_SigVol() 取当前的信号的手数, 如果当前信号是BPK(5), 则返回5.<br>例：<br>IF(F_SigVol() == VarOpi) //如果信号的仓位等于变量VarOpi |
| F_SigValid() | 当前信号是发出的，还是消失的<br>用法：<br>F_SigValid() 返回模型信号存在两种类型之一(信号发出，信号消失), 返回1表示信号发出, 返回0表示信号消失。<br>例：<br>IF(F_Sig()==BPK && F_SigValid()==1) //如果信号是BPK 且不是信号消失状态 |
| F_SigTime() | 当前信号的发出时间。<br>用法：<br>F_SigTime() 返回当前信号的发出时间(以总秒数表示)，<br>例：<br>IF(SamePeriod("m1109","min10",LastOrderTime(),F_SigTime()) //如果取得新信号的时间与上次交易的时间是同一个周期 |
| F_SigPos() | 当前信号在模型中是第几个有指令的语句。<br>用法：<br>F_SigPos() 如果当前信号是模型中第5个含信号的语句发出的，返回5<br>例：<br>IF(F_SigPos()==5) //如果当前信号是第5行发出的 |


#### 2.6.头寸函数 
| 函数 | 意义 |
|:---------:|:----------|
| LastOrderTime() | 最后一次下单的时间。<br>用法：<br>LastOrderTime()返回最后一次下单的时间，以总秒数表示<br>例：<br>IF(LastOrderTime() - CurrentTime() >= 300)如果距离上次下单时间超过5分钟 |
| T_BuyPosition(Code) | 交易系统某合约多头持仓。<br>用法：<br>T_BuyPosition(Code)返回交易系统中合约Code的多头持仓,Code为某合约的合约代码。<br>例：<br>VAR BuyVol;<br>BuyVol=T_BuyPosition("m1109"); //BuyVol为交易系统中合约代码为m1109的合约的多头持仓。 |
| T_BuyAvgPrice(Code) | 交易系统某合约多头持仓成本价。<br>用法：T_BuyAvgPrice(Code)返回交易系统合约Code的多头持仓成本价,Code为某合约合约代码。<br>例：<br>VAR BuyPrice; BuyPrice=T_BuyAvgPrice("m1109");// 定义一个变量BuyPrice,BuyPrice的值为交易系统合约m1109多头持仓成本价 |
| T_BuyProfitLoss(code) | 交易系统某合约的多头盈亏。<br>用法：<br>T_BuyProfitLoss(code)返回交易系统合约code的多头盈亏<br>例：<br>VAR BuyEarn;<br>BuyEarn=T_BuyProfitLoss("m1109");// 定义一个变量BuyEarn,BuyEarn的值为交易系统合约m1109的多头盈亏 |
| T_SellPosition(Code) | 交易系统某合约空头持仓。<br>用法：<br>T_SellPosition(Code)返回交易系统中合约Code的空头持仓,Code为某合约的合约代码。<br>例：<br>VAR SellVol;<br>SellVol=T_SellPosition("m1109");// SVol为交易系统中合约代码为m1109的合约的空头持仓。 |
| T_SellAvgPrice(code) | 交易系统某合约空头持仓成本价。<br>用法：T_SellAvgPrice(code)返回交易系统合约code的空头持仓成本价,code为某合约合约代码。<br>例：<br>VAR SellPrice;<br>SellPrice=T_SellAvgPrice("m1109");// 定义一个变量SellPrice,SellPrice的值为交易系统合约m1109空头持仓成本价 |
| T_SellProfitLoss(code) | 交易系统某合约的空头盈亏。<br>用法：<br>T_SellProfitLoss(code)返回交易系统合约code的空头盈亏<br>例：<br>VAR SellEarn;<br>SellEarn=T_SellProfitLoss("m1109") 定义一个变量SellEarn,SellEarn的值为交易系统合约m1109的空头盈亏 |
| T_Deal(Code,bs,kp,vol,price) | 发出委托。<br>用法：<br>T_Deal(Code,bs,kp,vol,price),发出委托。Code(字符串):合约编码，bs(整数0，1):0 买 1 卖 ，kp(整数0，1，2):0 开 1平 2平今 Vol(整数)：下单手数，Price(整数或小数):下单价格，0为市价 返回唯一委托标识OrderID(字符串)<br>例：<br>VAR orderID=T_Deal("m1109", 0, 0, 5, 2900); 发出委托：m1109 买开5手 限价2900 |
| T_FreeMargin(Type) | 可用资金。<br>用法T_FreeMargin(Type), 返回可用资金。　Type(整数 0, 1) 0期货 1股票，返回可用资金数(小数)<br>例：<br>VAR margin;<br>margin=T_FreeMargin(0); //返回当前期货帐户的可用资金数 |
| T_Equity(Type) | 权益。<br>用法T_Equity(Type), 返回权益。　Type(整数 0, 1) 0期货 1股票，返回权益(小数)<br>例：<br>VAR margin;<br>margin=T_Equity(0); //返回当前期货帐户的权益数 |
| T_MaxOpen(Code, margin, bs) | 某品种最大可开仓手数。、<br>用法：<br>T_MaxOpen(Code, margin, bs),某品种最大可开仓手数。Code(字符串):合约编码，margin(小数)：保证金比例　bs(整数0,1):0 买 1 卖　返回该品种在当前可用资金，当前价格下的可开仓手数(整数)<br>例：<br>VAR vol;<br>vol=T_MaxOpen("m1109", 0.1, 0); //变量vol为m1109 的　在保证金比例为0.1 下的可开仓手数 |
| T_OrderState(OrderID) | 查询委托状态。<br>用法：<br>T_OrderState(OrderID)根据委托唯一标识OrderID(字符串)查委托状态,返回值含义：-1查询失败 0挂单　1成交 2被撤单　3部份成交 4 其它<br>例：<br>IF(T_OrderState(X)=0) 如果委托X是挂单 |
| T_OpenOrder(Code,Type) | 查询挂单数量。<br>用法：<br>T_OpenOrder(Code,Type)返回未成交委托数量,Code:交易编码,Type:0所有方向;1买开;2卖平;3卖开;4买平<br>例：<br>IF(LastOrderTime() - CurrentTime >= 300 && T_OpenOrder(ru1009,1)>0) <br>T_OpenOrder("ru1009",1) //如果距离上次下单超过5分钟，且存在买开挂单,撤掉剩余买开委托合约X的未成交委托数量 |
| T_DeleteOrder(OrderID) | 委托撤单。<br>用法：<br>T_DeleteOrder(OrderID)根据委托唯一标识orderID(字符串)撤单，返回0撤单发出成功，返回其它失败<br>例：<br>IF(T_DeleteOrder(orderID)!=0)如果撤单失败 |
| T_DeleteOrderByCode(Code,Type) | 委托撤单(通过合约代码)。<br>用法：<br>T_DeleteOrderByCode(Code,Type)委托撤单。Code:合约代码(字符串)Type:0所有方向;1买开;2卖平;3卖开;4买平 返回0撤单发出成功，返回其它失败<br>例：<br>T_DeleteOrderByCode("ru1009",2)撤单橡胶1009的卖平委托 |
| T_DeleteOrderAll() | 撤掉所有未成交委托。<br>用法：<br>T_DeleteOrderAll()撤掉所有该模型相关的未成缴委托单，返回0撤单发出成功，返回其它失败<br>例：<br>IF(T_DeleteOrderAll()!=0)//如果撤单失败 |
| T_AddBuyOpiTo(Code, Price, Vol) | 根据当前成交的量采用买开的手段达到把仓位增加某一数值的目的。<br>用法：<br>T_AddBuyOpiTo(Code, Price, Vol)把多头仓位增加到某一数值。Code(字符串):合约代码,Price(小数):价格,Vol(整数):成交量 对合约代码为Code的字符串以Price价格下单达到多头vol手持仓<br>例：<br>T_AddBuyOpiTo("m1109", Price("m1109")+5, 10); //买开使多头持仓达到10手 |
| T_AddSellOpiTo(Code, Price, Vol) | 根据当前成交的量采用卖开的手段达到把仓位增加到指定值的目的。<br>用法：<br>T_AddSellOpiTo(Code, Price, Vol)把空头仓位增加到某一数值。Code(字符串):合约代码,Price(小数):价格,Vol(整数):成交量 对合约代码为Code的字符串以Price价格下单达到多头vol手持仓<br>例：<br>T_AddSellOpiTo("m1109", Price("m1109")-5, 10); //卖开使空头持仓达到10手 |
| T_ReduceBuyOpiTo(Code, Price, Vol) | 根据当前成交的量采用卖平的手段达到把仓位减少到某一数值的目的。<br>用法：<br>T_ReduceBuyOpiTo(Code, Price, Vol)把多头仓位减少到某一数值。Code(字符串):合约代码,Price(小数):价格,Vol(整数):成交量 对合约代码为Code的字符串以Price价格下单达到多头vol手持仓<br>例：<br>T_ReduceBuyOpiTo("m1109", Price("m1109")-5, 10); //卖平使多头持仓减少到10手 |
| T_ReduceSellOpiTo(Code, Price, Vol) | 根据当前成交的量采用买平的手段达到把仓位减少到某一数值的目的。<br>用法：<br>T_ReduceSellOpiTo(Code, Price, Vol)把空头仓位减少到某一数值。Code(字符串):合约代码,Price(小数):价格,Vol(整数):成交量 对合约代码为Code的字符串以Price价格下单达到空头vol手持仓<br>例：<br>T_ReduceSellOpiTo("m1109", Price("m1109")-5, 10); //卖开使空头持仓减少到10手 |
| T_StgBuyVol(Code) | 当前算法交易模型产生的某品种的多头持仓。<br>用法：<br>T_StgBuyVol(Code)返回当前算法交易模型产生的合约代码为Code的合约的多头持仓数。Code(字符串):合约代码<br>例：<br>T_StgBuyVol("m1109"); //当前算法交易模型产生的某品种多头持仓数 |
| T_StgSellVol(Code) | 当前算法交易模型产生产生的某品种的空头持仓。<br>用法：<br>T_StgSellVol(Code)返回当前算法交易模型产生的合约代码为Code的合约的空头持仓数。Code(字符串):合约代码<br>例：<br>T_StgSellVol("m1109"); //当前算法交易模型产生的某品种空头持仓数 |
| T_OrderMatchVol(OrderID) | 某次委托已经成交的数量。<br>用法：<br>T_OrderMatchVol(OrderID)根据委托唯一标识OrderID查询委托成交手数,返回成交手数。OrderID(字符串)<br>例：<br>VAR matchvol;<br>matchvol=T_OrderMatchVol(X); //matchvol为某次委托的已成交数量 |
| T_IsNoOrder() | 该算法交易模型无挂单(发出的所有委托都已经成交，或被撤单)。<br>用法：<br>T_IsNoOrder()如果没有挂单返回1，否则返回0<br>例： <br>IF(T_IsNoOrder()) //如果没有挂单 |



```java
import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.TypeReference;

import java.text.MessageFormat;
import java.util.ArrayList;
import java.util.List;

public class Test {
    private static final String jsonStr = "[]";
    public static void main(String[] args) {
        List<Table> tables = JSON.parseObject(jsonStr, new TypeReference<ArrayList<Table>>() {});
        for (Table table:tables) {
            System.out.println("#### "+table.getTitle()+"\n| 函数 | 意义 |\n|:---------:|:----------|");
            for (Line line:table.lines) {
                String funcName  = line.getFuncName();
                String[] funcMeans = line.getFuncMeanLines();
                StringBuffer sb = new StringBuffer(funcMeans[0]);
                for (int i = 1; i < funcMeans.length; i++) {
                    sb.append("<br>"+funcMeans[i]);
                }
                System.out.println(MessageFormat.format("| {0} | {1} |", funcName, sb.toString()));
            }
        }
    }
}

class Line {
    private String funcName;
    private String[] funcMeanLines;
    public Line() { }

    public Line(String funcName, String[] funcMeanLines) {
        this.funcName = funcName;
        this.funcMeanLines = funcMeanLines;
    }

    public String getFuncName() {
        return funcName;
    }

    public void setFuncName(String funcName) {
        this.funcName = funcName;
    }

    public String[] getFuncMeanLines() {
        return funcMeanLines;
    }

    public void setFuncMeanLines(String[] funcMeanLines) {
        this.funcMeanLines = funcMeanLines;
    }
}

class Table {
    private String type;
    private String title;
    private Integer sort;
    public List<Line> lines = new ArrayList();
    public Table() { }

    public Table(String type, String title, Integer sort) {
        this.type = type;
        this.title = title;
        this.sort = sort;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public Integer getSort() {
        return sort;
    }

    public void setSort(Integer sort) {
        this.sort = sort;
    }

    public List<Line> getLines() {
        return lines;
    }

    public void setLines(List<Line> lines) {
        this.lines = lines;
    }
}
```

```json
[{"lines":[{"funcMeanLines":["取得均价(在盘后对于国内三个期货交易所指结算价)"],"funcName":"AVPRICE"},{"funcMeanLines":["取得结算价(只有在日线周期盘后才能取得当日的结算价)","说明：如果用在周期小于'日'的K线上如5分钟K线，一小时k线，每根k线返回的值表示这根k线当日开盘时到这根k线的为止的结算价(均价)","如果用在周期大于等于'日'的K线上，返回当根K线结束时间所在日的结算价."],"funcName":"SETTLE"},{"funcMeanLines":["取得收盘价(在盘中指最新价)，也可简写为 C 。"],"funcName":"CLOSE"},{"funcMeanLines":["求高价，也可简写为 H 。"],"funcName":"HIGH"},{"funcMeanLines":["求最低价，也可简写为L 。"],"funcName":"LOW"},{"funcMeanLines":["求开盘价，也可简写为O 。"],"funcName":"OPEN"},{"funcMeanLines":["取持仓量"],"funcName":"OPI"},{"funcMeanLines":["引用X在N个周期前的值","例:REF(CLOSE,5);表示引用当前周期前第5个周期的收盘价"],"funcName":"REF(X,N)"},{"funcMeanLines":["引用N个周期后的数据。（N为大于等于1的整数）『未来函数』","例：REFX(CLOSE,5);表示引用自当前周期后第5个周期的收盘价 本函数运算量很大，将占用很多的CPU资源，导致行情刷新速度变慢，请谨慎使用!"],"funcName":"REFX(X,N)"},{"funcMeanLines":["引用某品种在某个周期上加载了某个指标的数据。","用法：#IMPORT [CODE, PERIOD, FORMULA] AS VAR。引用 CODE 所对应的合约 PERIOD 周期下指标 FORMULA 的数据。","CODE 文华码，PERIOD 周期，FORMULA 引用指标名，VAR定义变量名","注意：","1.只能引用 .FML/.XFML文件","2.只能引用如下周期：MIN1 MIN3 MIN5 MIN15 MIN30 HOUR1 DAY WEEK MONTH","3.只能短周期引用长周期 ","4.被引用的指标中不能存在引用","5.如果不写文华码，默认引用当前合约"],"funcName":"#MPORT"},{"funcMeanLines":["返回某品种的最小变动价位。","用法：MINPRICE(CODE); 返回CODE所对应合约的最小变动价位。","CODE 文华码或交易代码。例：MINPRICE('IF1107'); 表示返回IF1007的最小变动价位。","注意：某些合约（如橡胶指数）查不到最小变动价位，返回0。"],"funcName":"MINPRICE"},{"funcMeanLines":["求成交量，也可简写为V 。"],"funcName":"VOL"}],"sort":1,"title":"1.历史数据引用","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["取秒周期末买1价（K线图）或该笔TICK时刻的买1价（Tick图）。","用法：","L2_BID1 K线图时返回当前秒周期最后时刻的买1价。TICK图时返回该笔TICK时刻的买1价。"],"funcName":"L2_BID1"},{"funcMeanLines":["取秒周期末买2价（K线图）或该笔TICK时刻的买2价（Tick图）。","用法：","L2_BID2 K线图时返回当前秒周期最后时刻的买2价。TICK图时返回该笔TICK时刻的买2价。"],"funcName":"L2_BID2"},{"funcMeanLines":["取秒周期末买3价（K线图）或该笔TICK时刻的买3价（Tick图）。","用法：","L2_BID3 K线图时返回当前秒周期最后时刻的买3价。TICK图时返回该笔TICK时刻的买3价。"],"funcName":"L2_BID3"},{"funcMeanLines":["取秒周期末买4价（K线图）或该笔TICK时刻的买4价（Tick图）。","用法：","L2_BID4 K线图时返回当前秒周期最后时刻的买4价。TICK图时返回该笔TICK时刻的买4价。"],"funcName":"L2_BID4"},{"funcMeanLines":["取秒周期末买5价（K线图）或该笔TICK时刻的买5价（Tick图）。","用法：","L2_BID5 K线图时返回当前秒周期最后时刻的买5价。TICK图时返回该笔TICK时刻的买5价。"],"funcName":"L2_BID5"},{"funcMeanLines":["取秒周期末卖1价（K线图）或该笔TICK时刻的卖1价（Tick图）。","用法：","L2_ASK1 K线图时返回当前秒周期最后时刻的卖1价。TICK图时返回该笔TICK时刻的卖1价。"],"funcName":"L2_ASK1"},{"funcMeanLines":["取秒周期末卖2价（K线图）或该笔TICK时刻的卖2价（Tick图）。","用法：","L2_ASK2 K线图时返回当前秒周期最后时刻的卖2价。TICK图时返回该笔TICK时刻的卖2价。"],"funcName":"L2_ASK2"},{"funcMeanLines":["取秒周期末卖3价（K线图）或该笔TICK时刻的卖3价（Tick图）。","用法：","L2_ASK3 K线图时返回当前秒周期最后时刻的卖3价。TICK图时返回该笔TICK时刻的卖3价。"],"funcName":"L2_ASK3"},{"funcMeanLines":["取秒周期末卖4价（K线图）或该笔TICK时刻的卖4价（Tick图）。","用法：","L2_ASK4 K线图时返回当前秒周期最后时刻的卖4价。TICK图时返回该笔TICK时刻的卖4价。"],"funcName":"L2_ASK4"},{"funcMeanLines":["取秒周期末卖5价（K线图）或该笔TICK时刻的卖5价（Tick图）。","用法：","L2_ASK5 K线图时返回当前秒周期最后时刻的卖5价。TICK图时返回该笔TICK时刻的卖5价。"],"funcName":"L2_ASK5"},{"funcMeanLines":["取秒周期末买1量（K线图）或该笔TICK时刻的买1量（Tick图）。","用法：","L2_BID1 K线图时返回当前秒周期最后时刻的买1量。TICK图时返回该笔TICK时刻的买1量。"],"funcName":"L2_BIDVOL1"},{"funcMeanLines":["取秒周期末买2量（K线图）或该笔TICK时刻的买2量（Tick图）。","用法：","L2_BID2 K线图时返回当前秒周期最后时刻的买2量。TICK图时返回该笔TICK时刻的买2量。"],"funcName":"L2_BIDVOL2"},{"funcMeanLines":["取秒周期末买3量（K线图）或该笔TICK时刻的买3量（Tick图）。","用法：","L2_BID3 K线图时返回当前秒周期最后时刻的买3量。TICK图时返回该笔TICK时刻的买3量。"],"funcName":"L2_BIDVOL3"},{"funcMeanLines":["取秒周期末买4量（K线图）或该笔TICK时刻的买4量（Tick图）。","用法：","L2_BID4 K线图时返回当前秒周期最后时刻的买4量。TICK图时返回该笔TICK时刻的买4量。"],"funcName":"L2_BIDVOL4"},{"funcMeanLines":["取秒周期末买5量（K线图）或该笔TICK时刻的买5量（Tick图）。","用法：","L2_BID5 K线图时返回当前秒周期最后时刻的买5量。TICK图时返回该笔TICK时刻的买5量。"],"funcName":"L2_BIDVOL5"},{"funcMeanLines":["取秒周期末卖1量（K线图）或该笔TICK时刻的卖1量（Tick图）。","用法：","L2_ASK1 K线图时返回当前秒周期最后时刻的卖1量。TICK图时返回该笔TICK时刻的卖1量。"],"funcName":"L2_ASKVOL1"},{"funcMeanLines":["取秒周期末卖2量（K线图）或该笔TICK时刻的卖2量（Tick图）。","用法：","L2_ASK2 K线图时返回当前秒周期最后时刻的卖2量。TICK图时返回该笔TICK时刻的卖2量。"],"funcName":"L2_ASKVOL2"},{"funcMeanLines":["取秒周期末卖3量（K线图）或该笔TICK时刻的卖3量（Tick图）。","用法：","L2_ASK3 K线图时返回当前秒周期最后时刻的卖3量。TICK图时返回该笔TICK时刻的卖3量。"],"funcName":"L2_ASKVOL3"},{"funcMeanLines":["取秒周期末卖4量（K线图）或该笔TICK时刻的卖4量（Tick图）。","用法：","L2_ASK4 K线图时返回当前秒周期最后时刻的卖4量。TICK图时返回该笔TICK时刻的卖4量。"],"funcName":"L2_ASKVOL4"},{"funcMeanLines":["取秒周期末卖5量（K线图）或该笔TICK时刻的卖5量（Tick图）。","用法：","L2_ASK5 K线图时返回当前秒周期最后时刻的卖5量。TICK图时返回该笔TICK时刻的卖5量。"],"funcName":"L2_ASKVOL5"},{"funcMeanLines":["取Tick图中该笔TICK的成交价。","用法：","L2_PRICE 返回TICK图中该笔TICK的成交价。"],"funcName":"L2_PRICE"},{"funcMeanLines":["取TICK图中该笔TICK的成交量。","用法：","L2_VOLUME 返回TICK图中该笔TICK的成交量。"],"funcName":"L2_VOLUME"},{"funcMeanLines":["TICK图中该笔Tick 盘口中空头满足大单条件的与最新价的最近价格。","用法：","ASKBIGVOLPRICE 返回TICK图中该笔Tick 盘口满足大单条件的与最新价的最近价格, 注模型中需调用一次CALVOLPRICELIST函数"],"funcName":"ASKBIGVOLPRICE"},{"funcMeanLines":["TICK图中该笔Tick 盘口中多头满足大单条件的与最新价的最近价格。","用法：","BIDBIGVOLPRICE 返回TICK图中该笔Tick 盘口满足大单条件的与最新价的最近价格, 注模型中需调用一次CALVOLPRICELIST函数"],"funcName":"BIDBIGVOLPRICE"},{"funcMeanLines":["TICK图中初始化盘口大单价格表,主要在BIDBIGVOLPRICE 与ASKBIGVOLPRICE 前使用，提供初始化。","用法：","CALVOLPRICELIST"],"funcName":"CALVOLPRICELIST"},{"funcMeanLines":["设置大单成交手数阈值 ","用法：","L2_SETBIGVOL( nVol ) 成交手数大于nVol的为大单，","例：L2_SETBIGVOL( 10 ); // 大于10手的是大单 ","L2_BKBIGCOUNT; // 查看买开的大单成交次数;"],"funcName":"L2_SETBIGVOL"},{"funcMeanLines":["取秒周期主动买的成交量。","用法：","L2_BIDVOL 返回当前秒周期主动买的成交量"],"funcName":"L2_BIDVOL"},{"funcMeanLines":["取秒周期主动卖的成交量。","用法：","L2_ASKVOL 返回当前秒周期主动卖的成交量"],"funcName":"L2_ASKVOL"},{"funcMeanLines":["取秒周期主动买的大单成交次数。","用法：","L2_BIDBIGCOUNT 返回当前秒周期主动买的大单成交次数"],"funcName":"L2_BIDBIGCOUNT"},{"funcMeanLines":["取秒周期主动卖的大单成交次数。","用法：","L2_ASKBIGCOUNT 返回当前秒周期主动卖的大单成交次数"],"funcName":"L2_ASKBIGCOUNT"},{"funcMeanLines":["取秒周期主动买的大单成交量。","用法：","L2_BIDBIGTOTVOL 返回当前秒周期主动买的大单成交量"],"funcName":"L2_IDBIGTOTVOL"},{"funcMeanLines":["取秒周期主动卖的大单成交量。","用法：","L2_ASKBIGTOTVOL 返回当前秒周期主动卖的大单成交量"],"funcName":"L2_ASKBIGTOTVOL"},{"funcMeanLines":["取秒周期买开的成交量。","用法：","L2_BKVOL 返回当前秒周期买开的成交量"],"funcName":"L2_BKVOL"},{"funcMeanLines":["取秒周期卖开的成交量。","用法：","L2_SKVOL 返回当前秒周期卖开的成交量"],"funcName":"L2_SKVOL"},{"funcMeanLines":["取秒周期买平的成交量。","用法：","L2_BPVOL 返回当前秒周期买平的成交量"],"funcName":"L2_BPVOL"},{"funcMeanLines":["取秒周期卖平的成交量。","用法：","L2_SPVOL 返回当前秒周期卖平的成交量"],"funcName":"L2_SPVOL"},{"funcMeanLines":["取秒周期买开的大单成交次数。","用法：","L2_BKBIGCOUNT 返回当前秒周期买开的大单成交次数"],"funcName":"L2_BKBIGCOUNT"},{"funcMeanLines":["取秒周期卖开的大单成交次数。","用法：","L2_SKBIGCOUNT 返回当前秒周期卖开的大单成交次数"],"funcName":"L2_SKBIGCOUNT"},{"funcMeanLines":["取秒周期买平的大单成交次数。","用法：","L2_BPBIGCOUNT 返回当前秒周期买平的大单成交次数"],"funcName":"L2_BPBIGCOUNT"},{"funcMeanLines":["取秒周期卖平的大单成交次数。","用法：","L2_SPBIGCOUNT 返回当前秒周期卖平的大单成交次数"],"funcName":"L2_SPBIGCOUNT"},{"funcMeanLines":["取秒周期买开的大单成交量。","用法：","L2_BKBIGTOTVOL 返回当前秒周期买开的大单成交量"],"funcName":"L2_BKBIGTOTVOL"},{"funcMeanLines":["取秒周期卖开的大单成交量。","用法：","L2_SKBIGTOTVOL 返回当前秒周期卖开的大单成交量"],"funcName":"L2_SKBIGTOTVOL"},{"funcMeanLines":["取秒周期买平的大单成交量。","用法：","L2_BPBIGTOTVOL 返回当前秒周期买平的大单成交量"],"funcName":"L2_BPBIGTOTVOL"},{"funcMeanLines":["取秒周期卖平的大单成交量。","用法：","L2_SPBIGTOTVOL 返回当前秒周期卖平的大单成交量"],"funcName":"L2_SPBIGTOTVOL"}],"sort":2,"title":"2.日内高频数据引用","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["根据文华码取出某一品种的最新价。","例：GETPRICE(1209);返回文华码为1209的合约品种的最新价。"],"funcName":"GETPRICE(N)"}],"sort":3,"title":"3.行情数据引用","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["若X条件成立,则将当前位置到N周期前的数值设为1。『未来函数』","例：BACKSET(CLOSE>OPEN,3);表示当K线收阳时，自当前位置到3周期前的数值设为1"],"funcName":"BACKSET(X,N)"},{"funcMeanLines":["求上一次条件成立到当前的周期数。"],"funcName":"BARSLAST(X)"},{"funcMeanLines":["表示统计在N周期内满足X条件的周期数。如果N为0则表示从已申请到的数据的第一天开始算起。","例：WR:=-100*(HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N)); COUNT(WR>80,5);表示统计在5个周期内满足WR>80的次数"],"funcName":"COUNT(X,N)"},{"funcMeanLines":["返回X的动态移动平均，其中A为常数，并且必须介于0及1之间。","计算方法：DMA(N)=DMA(N-1)*(1-A)+X(N)*A 其中DMA(N-1)为第(N-1)天的DMA值。"],"funcName":"DMA(X,A)"},{"funcMeanLines":["表示求X在N周期内的平滑移动平均。（指数加权）","计算方法：EMA(X,N)=[2*X+(N-1)*EMA(X,(N-1))]/(N+1) 其中EMA(X,(N-1))为第(N-1)天的EMA值"],"funcName":"EMA(X,N)"},{"funcMeanLines":["表示求X在N周期内的加权平均。（线性加权）","计算方法：EMA2(X,N)=(N*X0+(N-1)*X1+(N-2)*X2+...+1*XN-1)/(N+(N-1)+(N-2)+...+1),X0表示本周期值，X1表示上一周期值..."],"funcName":"EMA2(X,N)"},{"funcMeanLines":["得到X在N周期内的最高值，如果N＝0，则从本地数据的第一个有效周期开始算起。","例：HHV(HIGH,13);求13个周期内的最高价的最大值。"],"funcName":"HHV(X,N)"},{"funcMeanLines":["得到X在N周期内的最高值位置到当前的周期数。如果N=0，则从本地数据的第一个有效周期开始算起。","例：HHVBARS(VOL,0); 求历史成交量最大的周期到当前的周期数"],"funcName":"HHVBARS(X,N)"},{"funcMeanLines":["得到X在N周期内的最小值，如果N=0，则从本地数据的第一个有效周期开始算起。","例：LLV(LOW,25);表示求25个周期内最低价的最小值"],"funcName":"LLV(X,N)"},{"funcMeanLines":["得到X在N周期内的最小值的位置到当前的周期数。如果N=0则从本地数据的第一个有效周期开始算起。","例：LLVBARS(VOL,0); 求历史成交量最小的周期到当前的周期数"],"funcName":"LLVBARS(X,N)"},{"funcMeanLines":["求X在N周期内的简单移动平均。","计算方法：MA=(A1+A2+A3+A4+A5)/5 求A在5个周期内的简单移动平均"],"funcName":"MA(X,N)"},{"funcMeanLines":["求线型回归的斜率。","用法：","SLOPE(X,N)得到X的N周期的线型回归的斜率。","例:SLOPE(CLOSE,5);表示求收盘价5个周期线性回归线的斜率"],"funcName":"SLOPE(X,N)"},{"funcMeanLines":["之字转向,当X变化量超过P时转向,当N取1,P为百分比数;当N取0,P为价位差值绝对值。『未来函数』","例：ZIGZAG(HIGH,10,1);表示最高价的10%的之字转向","ZIGZAG(MA(HIGH,34),100,0);表示34个周期内最高价均线的100个价位的之字转向"],"funcName":"ZIGZAG(X,P,N)"},{"funcMeanLines":["取得ZIGZAG前M个波峰的值。其中X为数据，P为转折值（如果N为1，这个值为百分比数，否则为价位差值绝对值），M为大于等于1的整数。『未来函数』","例：PEAK(HIGH,10,1,1);表示最高价的10%的之字转向的上一个波峰的数值;","PEAK(MA(HIGH,34),100,1,0);表示34个周期内最高价均线的100个价位的之字转向的上一个波峰的数值"],"funcName":"PEAK(X,P,M,N)"},{"funcMeanLines":["取得ZIGZAG前M个波峰到当前周期的周期数。其中X为数据，P为转折值（如果N为1，这个值为百分比数，否则为价位差值绝对值），M为大于等于1的整数。『未来函数』","例：PEAKBARS(HIGH,10,1,1);表示最高价的10%的之字转向的上一个波峰到当前的周期数","PEAKBARS(MA(HIGH,34),100,1,0);表示34个周期内最高价均线的100个价位的之字转向的上一个波峰到当前的周期数"],"funcName":"PEAKBARS(X,P,M,N)"},{"funcMeanLines":["取得ZIGZAG前M个波谷的值。其中X为数据，P为转折值（如果N为1，这个值为百分比数，否则为价位差值绝对值），M为大于等于1的整数。『未来函数』","例：TROUGH(LOW,10,1,1);表示最低价的10%的之字转向的上一个波谷的数值","TROUGH (MA(LOW,34),100,1,0);表示34个周期内最低价均线的100个价位的之字转向的上一个波谷的数值"],"funcName":"TROUGH(X,P,M,N)"},{"funcMeanLines":["取得ZIGZAG前M个波谷到当前周期的周期数。其中X为数据，P为转折值（如果N为1，这个值为百分比数，否则为价位差值绝对值），M为大于等于1的整数。『未来函数』","TROUGH(LOW,10,1,1);表示最低价的10%的之字转向的上一个波谷到当前的周期数","TROUGH (MA(LOW,34),100,1,0);表示34个周期内最低价均线的100个价位的之字转向的上一个波谷到当前的周期数"],"funcName":"TROUGHBARS(X,P,M,N)"},{"funcMeanLines":["得到抛物转向值。N为计算周期,Step为步长,Max为极值。（系统函数，计算步骤后台自动完成）","例：SAR(17,0.03,0.3);表示计算17个周期抛物转向，步长为3%，极限值为30%"],"funcName":"SAR(N,Step,Max"},{"funcMeanLines":["得到X在N个周期内的移动平均，M为权重（M为常数）。","计算方法：SMA(N)=SMA(N-1)*(N-M)/N+X(N)*M/N"],"funcName":"SMA(X,N,M)"},{"funcMeanLines":["求标准差。","用法：","STD(X,N)求X在N个周期内的标准差。"],"funcName":"STD(X,N)"},{"funcMeanLines":["求总体标准差。","用法：","STDP(X,N)为X的N日总体标准差。"],"funcName":"STDP(X,N)"},{"funcMeanLines":["得到X在N周期内的总和，如果N=0，则从第一个有效周期开始算起。","例: SUM(VOL,10);表示统计10周期内的成交量总和"],"funcName":"SUM(X,N)"},{"funcMeanLines":["得到X向前累加直到大于A时的周期数。"],"funcName":"SUMBARS(X,A)"},{"funcMeanLines":["求X在N周期内的三角移动平均。"],"funcName":"TRMA(X,N)"},{"funcMeanLines":["求X在N周期内的时间序列移动平均。","计算方法：TSMA(X,N)= FOCAST(X,N)+SLOPE(X,N)"],"funcName":"TSMA(X,N)"}],"sort":4,"title":"4.金融统计","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["求X在N周期内的平均绝对偏差"],"funcName":"AVEDEV(X,N)"},{"funcMeanLines":["数据偏差平方和。"],"funcName":"DEVSQ(XN)"},{"funcMeanLines":["得到X的N周期线性回归预测值。","例:FORCAST(CLOSE,5);表示求5周期线性回归预测"],"funcName":"FORCAST(X,N)"},{"funcMeanLines":["得到X在N周期内的样本方差"],"funcName":"VAR(X,N)"},{"funcMeanLines":["得到X在N周期内的总体样本方差"],"funcName":"VARP(X,N)"},{"funcMeanLines":["设一个数列，数列中数据的总个数为N，以今天（2005-10-14）五天内的A0605收盘价为例，N就为5。数列的内容为：｛2766，2805，2814，2886，2885｝。","1、算术平均值MA(CLOSE,5)：数据总和除以总个数N。 (2766+2805+2814+2886+2885)/5=2831.20。 可以用公式MA(CLOSE,5),从今天的值上看出。","2、偏差：每个数据，减去算术平均值的结果。 2766-2831.20=-65.2， 2805-2831.20=-26.2, 2814-2831.20=-17.2, 2886-2831.20=54.8, 2885-2831.20=53.8, 各偏差相加，应该是等于0的。","3、平均绝对偏差AVEDEV(X,N)：将偏差的绝对值相加，除以总个数N。 (65.2+26.2+17.2+54.8+53.8)/5=43.44 ","4、数据偏差平方和DEVSQ(X,N)：将偏差的平方相加。 (-65.2)2+ (-26.2)2+ (-17.2)2+ (54.8)2+ (53.8)2=11130.80 ","5、总体样本方差VARP(X,N)：将偏差的平方相加，总和除以总个数N。用公式可以这样算： (-65.2)2+ (-26.2)2+ (-17.2)2+ (54.8)2+ (53.8)2/5=2226.16 ","6、样本方差VAR(X,N)：是总体方差的N/(N-1)倍。 2226.16*5/(5-1)=2782.70 估算样本方差，总比总体样本方差大一点，当N够大时，两者趋于相等。"],"funcName":"数理统计举例说明："}],"sort":5,"title":"5.数理统计","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["判断条件“A位于B及C之间”是否成立，如果条件成立则返回1 (yes),否则返回0 (no)。","例：BETWEEN(CLOSE,MA5,MA40); 表示收盘价介于5日均线与40日均线之间。"],"funcName":"BETWEEN(A,B,C)"},{"funcMeanLines":["表示X上穿Y。","例：CROSS(CLOSE,MA(CLOSE,5));表示收盘线从下方向上穿过5日均线"],"funcName":"CROSS(X,Y)"},{"funcMeanLines":["两条线交叉。","用法:","CROSS2(A,B)表示当A从下方向上穿过B两次时返回1(Yes)，否则返回0(No)","例：CROSS2(CLOSE,MA(CLOSE,5));表示收盘线从下方向上穿过5日均线两次"],"funcName":"CROSS2(A,B)"},{"funcMeanLines":["过滤连续出现的信号。","用法：","FILTER(COND,N) 当COND条件成立时，将其后N周期内的数据置为0。","例：FILTER(CLOSE>OPEN,3) 查找阳线，3天内再次出现的阳线不被记录在内","注：不能与BKPRICE,BARSBK,SKPRICE,BARSSK一起使用"],"funcName":"FILTER(COND,N)"},{"funcMeanLines":["判断N个周期内是否有满足条件COND的情况发生。","例：EXIST(CLOSE>REF(HIGH,1),10);表示10个周期中是否存在收盘价大于前一个周期的最高价"],"funcName":"EXIST(COND,N)"},{"funcMeanLines":["判断过去N个周期内是否一直满足条件COND。","例：EVERY(CLOSE>OPEN,5);表示5个周期内一直是阳线"],"funcName":"EVERY(COND,N)"},{"funcMeanLines":["判断过去N1到N2周期内是否一直满足条件COND。","例：LAST(CLOSE>OPEN,10,5);表示从过去第10个周期到第5个周期内一直是阳线"],"funcName":"LAST(COND,N1,N2)"},{"funcMeanLines":["如果A在前N个周期内都小于B，本周期上穿B，则返回1。否则返回0。","例：LONGCROSS(CLOSE,MA(CLOSE,10),20);表示收盘线在10日均线之下持续20周期后从下向上穿过10日均线"],"funcName":"LONGCROS(A,B,N)"},{"funcMeanLines":["交易模型买卖指令信号过滤函数。（仅适用于交易模型的过滤）","交易模型公式后加“NOFILTER;”是指不需要过滤，出现任何交易指令都会执行。公式后不加“NOFILTER;”是指当连续出现同方向的交易指令时，系统只显示出第一个交易指令，其他交易指令自动被过滤。"],"funcName":"NOFILTER"},{"funcMeanLines":["如果条件C成立则取A值,否则取B值","例：A:=IFELSE(MA5>MA10,CROSS(DIFF,DEA),IFELSE(CROSS(D,K),2,0));当MA5>MA10时，取是否满足DIFF上穿DEA，否则(MA5不大于MA10)，当K,D死叉时，令A赋值为2，若上述条件都不满足，A赋值为0","A=1,BPK;//当MA5>MA10，以DIFF上穿DEA作为开多仓条件","A=2,SPK;//当MA5不大于MA10，以K D死叉作为开空仓条件"],"funcName":"IFELE(C,A,B)"},{"funcMeanLines":["判断该周期是否收阴。"],"funcName":"ISDOWN"},{"funcMeanLines":["判断该周期是否平盘。"],"funcName":"SEQUAL"},{"funcMeanLines":["判断该周期是否收阳。"],"funcName":"ISUP"},{"funcMeanLines":["判断当前周期是否为最后一根K线。"],"funcName":"ISLASTBAR"},{"funcMeanLines":["当条件COND满足时，取当时的DATA的值，否则取得前面一个满足条件COND的值。","例：VALUEWHEN(HIGH>REF(HIGH,5),HIGH);表示当前最高价大于前五个周期最高价的最大值时返回当前最高价。"],"funcName":"VALUEWHEN(COND,DATA)"}],"sort":6,"title":"6.逻辑判断","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["求X的绝对值","例：ABS(SAR(17,0.03,0.3));返回抛物转向SAR(17,0.03,0.3)的绝对值。"],"funcName":"ABS(X)"},{"funcMeanLines":["求X的反余弦值"],"funcName":"ACOS(X)"},{"funcMeanLines":["求X的反正弦值"],"funcName":"ASIN(X)"},{"funcMeanLines":["求X的反正切值"],"funcName":"ATAN(X)"},{"funcMeanLines":["返回X的余弦值"],"funcName":"COS(X)"},{"funcMeanLines":["返回e的X次幂"],"funcName":"EXP(X)"},{"funcMeanLines":["返回X的三次方。"],"funcName":"CUBE(X)"},{"funcMeanLines":["向上舍入，返回沿X数值增大方向最接近的整数。"],"funcName":"CEILING(X)"},{"funcMeanLines":["向下舍入，返回沿X数值减小方向最接近的整数。"],"funcName":"FLOOR(X)"},{"funcMeanLines":["取X的整数部分，返回沿X绝对值减小方向最接近的整数。"],"funcName":"INTPART(X)"},{"funcMeanLines":["得到X的自然对数，以e为底的对数。","例：LN(OPEN);求开盘价的自然对数。"],"funcName":"LN(X)"},{"funcMeanLines":["得到X的常用对数，取得X的以10为底的对数。","例：LOG(OPEN);求开盘价的以10为底的对数。"],"funcName":"LOG(X)"},{"funcMeanLines":["求A,B中的较大者。","例：MAX(CLOSE-OPEN,0);表示若收盘价大于开盘价返回它们的差值，否则返回0。"],"funcName":"MAX(A,B)"},{"funcMeanLines":["求A,B中的较小者。","例：MIN(OPEN,CLOSE);返回开盘价和收盘价中的较小值。"],"funcName":"MIN(A,B)"},{"funcMeanLines":["返回A对B得到模。","例：MOD(CLOSE,500);收盘价除以500所得余数"],"funcName":"MOD(A,B)"},{"funcMeanLines":["当X为0时返回1,否则返回0。","例：NOT(TIME=090530);表示该周期对应的时间不是9:05:30AM。"],"funcName":"NOT(X)"},{"funcMeanLines":["得到A的B次幂。","例：POW(CLOSE,2);求得收盘价的2次方。"],"funcName":"POW(A,B)"},{"funcMeanLines":["取反，返回符号相反的数值。","例：REVERSE(LOW);返回-LOW。"],"funcName":"REVERSE(X)"},{"funcMeanLines":["表示A大于B同时小于C时返回1，否则返回0"],"funcName":"RANGE(A,B,C)"},{"funcMeanLines":["得到X的符号，如果X>0则返回1,如果X<0则返回－1，否则返回0。"],"funcName":"SGN(X)"},{"funcMeanLines":["得到X的正弦值。"],"funcName":"SIN(X)"},{"funcMeanLines":["得到X的平方根。","例：SQRT(CLOSE);收盘价的平方根。"],"funcName":"SQRT(X)"},{"funcMeanLines":["得到X的平方。","例：SQUARE(CLOSE);收盘价的平方。"],"funcName":"SQUARE(X)"},{"funcMeanLines":["得到X的正切值。"],"funcName":"TAN(X)"}],"sort":7,"title":"7.数学运算","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["取得当前K线的位置。"],"funcName":"BARPOS"},{"funcMeanLines":["取得当前周期的日数（700101-341231）。"],"funcName":"DATE"},{"funcMeanLines":["取得当前周期的日数（1-31）。"],"funcName":"DAY"},{"funcMeanLines":["取得当前周期的小时数（0-23）。"],"funcName":"HOUR"},{"funcMeanLines":["取得当前周期的分钟数（0-59）。"],"funcName":"MINUTE"},{"funcMeanLines":["取得当前周期的月数（1-12）。"],"funcName":"MONTH"},{"funcMeanLines":["取得当前周期的时间数（0-2359），秒级周期返回值范围为：0-235959。"],"funcName":"TIME"},{"funcMeanLines":["取得当前周期的星期数（0-6）。"],"funcName":"WEEKDAY"},{"funcMeanLines":["取得当前周期的年数（1970-2034）。"],"funcName":"YEAR"}],"sort":8,"title":"8.时间函数","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["设置背景的样式。","用法：","BACKGROUNDSTYLE(i)设置背景的样式。","i = 0 或 1。"],"funcName":"BACKGROUNDSTYLE(i)"},{"funcMeanLines":["当条件C1及C2均满足时，从P1画直线到P2，颜色为COLOR。","例：DRAWLINE(MA18< CLOSE,OPEN,MA5 >CLOSE,CLOSE,COLORCYAN); 表示当收盘价大于18日均线并且小于5日均线时，从开盘价画青色直线到收盘价。"],"funcName":"DRAWLINE(C1,P1,C2,P2,COLOR)"},{"funcMeanLines":["表示当条件C满足时在P上写TEXT文字。","例：DRAWTEXT(CLOSE< OPEN&&REF(CLOSE,1)< REF(OPEN,1) &&REF(VOL,1)*1.1< VOL,LOW,'注'); 表示连续两日收阴并且成交量比前一日至少多10%时，在最低价上写“注”字。"],"funcName":"DRAWTEXT(C,P,TEXT)"},{"funcMeanLines":["画斜线，当条件COND满足时，从DATA开始以每个周期相差SLOPE个点的斜率画斜线，划线长度为LEN个周期，EXPAND为线段的延长方式（0：不延伸；1:向左延伸；2:向右延伸；3：双向延伸）。","例：DRAWSL(LOW=LLV(LOW,50),LOW,5,3,2,COLORRED); 表示当前最低价等于50周期内的最小值时，从当前最小值开始以每隔5个点的斜率画长度为3个周期向右延伸的斜线，颜色为红色"],"funcName":"DRAWSL(COND,DATA,SLOPE,LE,EXPAND, COLOR)"},{"funcMeanLines":["画数字。当条件COND满足时，在DATA位置写数字NUMBER（为数组），精度为PRECISION（小数点后有几位数字）。","例：DRAWNUMBER(CLOSE/OPEN>1.08,HIGH,(CLOSE-OPEN)/OPEN*100,2,COLORRED); 表示当日涨幅大于8%时在最高价位置显示涨幅(相对开盘价的百分比)。"],"funcName":"DRAWNUMBER (COND,DATA,NUMBER,PRECSION,COLOR)"},{"funcMeanLines":["填充区域，当条件COND满足时，填充DATA1及DATA2包围的区域。","例：FILLRGN(MA5>MA10,MA5,MA10,COLORRED); 表示MA5>MA10时以红色填充MA5和MA10之间的区域。"],"funcName":"FILLRGN (COND,DATA1,DATA2,COLOR)"},{"funcMeanLines":["当条件满足时，播放自定义声音'N'(自定义声音在插入声音文件中设置，最多可以设置10个)。","例：PLAYSOUND(CLOSE>OPEN,'A');表示CLOSE>OPEN时播放自定义声音'A'。"],"funcName":"PLAYSOUND(COND, 'N')"},{"funcMeanLines":["画折线，当条件COND满足时，连接各个DATA点。","例：POLYLINE(CLOSE>=HHV(CLOSE,100),CLOSE,COLORRED); 表示在收盘价创100天新高点之间画折线。"],"funcName":"POLYLINE (COND,DATA,COLOR)"},{"funcMeanLines":["同POLYLINE。","例：PARTLINE(HIGH>REF(HIGH,1),HIGH,COLORRED); 表示当期最高价大于前期最高价用红色绘制最高价连线线段。"],"funcName":"PARTLINE (COND,DATA,COLOR)"},{"funcMeanLines":["如果条件C满足时，从P1到P2画柱线，颜色为Color,如果Empty取1，则为空心柱；如果Empty取0，则为实心柱。","例：STICKLINE(OPEN-CLOSE>0,OPEN,CLOSE,COLORCYAN,0); 表示当开盘价大于收盘价时，从开盘价到收盘价画青色的实心柱，即K线阴线的实体部分。"],"funcName":"STICKLINE (C,P1,P2,Color,Empty)"},{"funcMeanLines":["画垂直线，当条件COND满足时，画垂直线。","例：VERTLINE(HIGH>=HHV(HIGH,30),COLORRED); 表示在价格创30天新高时画垂直线。"],"funcName":"VERTLINE (COND,COLOR)"},{"funcMeanLines":["自定义颜色函数。R,G,B的数值范围都在0~255之间，例：RGB(225,225,225)表示白色"],"funcName":"RGB(R,G,B)"},{"funcMeanLines":["画彩色柱线"],"funcName":"COLORSTICK"},{"funcMeanLines":["画成交量线"],"funcName":"VOLUMESTICK"},{"funcMeanLines":["画竹线"],"funcName":"BAMBOOLINE"},{"funcMeanLines":["画圆"],"funcName":"CIRCLEDOT"},{"funcMeanLines":["画持仓量柱线"],"funcName":"OPISTICK"}],"sort":9,"title":"9.绘图","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["红色"],"funcName":"COLORRED"},{"funcMeanLines":["绿色"],"funcName":"COLORGREEN"},{"funcMeanLines":["蓝色"],"funcName":"COLORBLUE"},{"funcMeanLines":["红紫色"],"funcName":"COLORMAGENTA"},{"funcMeanLines":["黄色"],"funcName":"COLORYELLOW"},{"funcMeanLines":["浅灰色"],"funcName":"COLORLIGHTGREY"},{"funcMeanLines":["浅红色"],"funcName":"COLORLIGHTRED"},{"funcMeanLines":["浅绿色"],"funcName":"COLORLIGHTGREEN"},{"funcMeanLines":["浅蓝色"],"funcName":"COLORLIGHTBLUE"},{"funcMeanLines":["黑色"],"funcName":"COLORBLACK"},{"funcMeanLines":["白色"],"funcName":"COLORWHITE"},{"funcMeanLines":["青色"],"funcName":"COLORCYAN"}],"sort":10,"title":"10.颜色常数","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["对模型的所有信号按照先买后卖，先开后平的顺序过滤。","用法：AUTOFILTER产生的指令将按照如下规则过滤：","1.连续的同方向指令只有第一个有效，其他的将被过滤；","2.交易指令必须配对出现（例如：前面已经有了买开指令，则后面只允许出现卖平指令，其他的指令都被滤掉。这也就意味着，第一个指令只能是买开或者卖开指令，其他的都被过滤）； 例：","CLOSE>OPEN,BPK;","CLOSE<OPEN,SPK;","AUTOFILTER;","注意如果使用自动过滤函数建议就不要在代码中再使用其它的语句进行过滤的编写。"],"funcName":"AUTOFILTER"},{"funcMeanLines":["上一次买开信号位置","用法：","BARSBK返回上一次买开仓距离当前k线的k线数。"],"funcName":"BARSBK"},{"funcMeanLines":["上一次卖开信号位置","用法：","BARSSK返回上一次卖开仓距离当前k线的k线数。"],"funcName":"BARSSK"},{"funcMeanLines":["判断上一个交易信号是否是BK。","用法：","ISLASTBK 如果上一个交易信号是BK则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTBK"},{"funcMeanLines":["判断上一个交易信号是否是SK。","用法：","ISLASTSK 如果上一个交易信号是SK则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTSK"},{"funcMeanLines":["判断上一个交易信号是否是BP。","用法：","ISLASTBP 如果上一个交易信号是BP则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTBP"},{"funcMeanLines":["判断上一个交易信号是否是SP。","用法：","ISLASTSP 如果上一个交易信号是SP则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTSP"},{"funcMeanLines":["判断上一个交易信号是否是BPK。","用法：","ISLASTBPK 如果上一个交易信号是BPK则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTBPK"},{"funcMeanLines":["判断上一个交易信号是否是SPK。","用法：","ISLASTSPK 如果上一个交易信号是SPK则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTSPK"},{"funcMeanLines":["合约手续费","用法：","FEE返回当前合约的手续费（用户启动模组时设置的）。","注意不能与未来函数同时使用如ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,TROUGH,TROUGHBARS,REFX等 本函数运算量很大，将占用很多的CPU资源，导致行情刷新速度变慢，请谨慎使用!"],"funcName":"FEE"},{"funcMeanLines":["判断上一个信号是否是BUYLONG","用法：","ISLASTBUYLONG 如果上一个交易信号是BUYLONG则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTBUYLONG"},{"funcMeanLines":["判断上一个信号是否是SELLSHORT","用法：","ISLASTSELLSHORT 如果上一个交易信号是SELLSHORT则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTSELLSHORT"},{"funcMeanLines":["判断上一个信号是否是EXITLONG","用法：","ISLASTEXITLONG 如果上一个交易信号是EXITLONG则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTEXITLONG"},{"funcMeanLines":["判断上一个信号是否是EXITSHORT","用法：","ISLASTEXITSHORT 如果上一个交易信号是EXITSHORT则返回1（Yes），否则返回0（No）"],"funcName":"ISLASTEXITSHORT"},{"funcMeanLines":["买开信号位置的买开信号价位。","用法：","BKPRICE返回最近一次模型买开位置的买开信号价位。","例如:","BKPRICE-CLOSE>60 && BKPRICE>0, SP;//如果买开价位比当前价位高出60,且买开价位存在，卖平仓","请注意当模型存在连续多个开仓信号(加仓)的情况下，该函数返回的是最后一次开仓信号的价格,而不是开仓均价。","注：BKPRICE 只在加载之后的K线上才返回信号价位，历史K线信号由于无信号价位会返回0，使用时请注意判断BKPRICE>0。效果测试中该函数返回信号位置的收盘价"],"funcName":"BKPRICE"},{"funcMeanLines":["卖开信号位置的卖开信号价位","用法：","SKPRICE返回最近一次模型卖开位置的卖开信号价位。","例如:","CLOSE-SKPRICE>60 && SKPRICE>0, BP;//如果当前价位高出卖开价位60， 且卖开价位存在, 买平仓","请注意当模型存在连续多个开仓信号(加仓)的情况下，该函数返回的是最后一次开仓信号的价格,而不是开仓均价。","注：SKPRICE 只在加载之后的K线上才返回信号价位，历史K线信号由于无","信号价位会返回0，使用时请注意判断SKPRICE>0。效果测试中该函数返回信号位置的收盘价"],"funcName":"SKPRICE"},{"funcMeanLines":["上一次买平信号位置","用法：","BARSBP返回上一次买平仓距离当前k线的k线数。"],"funcName":"BARSBP"},{"funcMeanLines":["上一次卖平信号位置","用法：","BARSSP返回上一次卖平仓距离当前k线的k线数。"],"funcName":"BARSSP"},{"funcMeanLines":["判断上一次交易的信号","用法：","LASTSIG返回上一次交易的信号。","注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,","TROUGH,TROUGHBARS,REFX等可能会导致误差。"],"funcName":"LASTSIG"},{"funcMeanLines":["虚拟资金余额","用法：","MONEY返回虚拟资金余额。","注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,","TROUGH,TROUGHBARS,REFX等可能会导致误差。"],"funcName":"MONEY"},{"funcMeanLines":["模型虚拟多头持仓","用法：","BUYVOL返回模型虚拟多头持仓。","注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,","TROUGH,TROUGHBARS,REFX等可能会导致误差。"],"funcName":"BUYVOL"},{"funcMeanLines":["模型虚拟空头持仓","用法：","SELLVOL返回模型虚拟空头持仓。","注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,","TROUGH,TROUGHBARS,REFX等可能会导致误差。"],"funcName":"SELLVOL"},{"funcMeanLines":["合约保证金","用法：","MARGIN返回当前合约的保证金比率（用户启动模组时设置的）。","注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,","TROUGH,TROUGHBARS,REFX等可能会导致误差。"],"funcName":"MARGIN"},{"funcMeanLines":["模型虚拟空头持仓","用法：","VOLMARGIN计算当前的持仓保证金。","注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,","TROUGH,TROUGHBARS,REFX等可能会导致误差。"],"funcName":"VOLMARGIN"},{"funcMeanLines":["资金使用率","用法：","MONEYRATIO返回当前的虚拟资金的使用率。","注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,","TROUGH,TROUGHBARS,REFX等可能会导致误差。"],"funcName":"MONEYRATIO"},{"funcMeanLines":["虚拟总资金","用法：","MONEYTOT返回当前虚拟总资金（虚拟资金余额+持仓保证金）。","注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,","TROUGH,TROUGHBARS,REFX等可能会导致误差。"],"funcName":"MONEYTOT"},{"funcMeanLines":["虚拟逐笔浮盈","用法：","PROFIT返回当前的虚拟逐笔浮动盈亏。","注意与未来函数同时使用ISLASTBAR,EMA2,ZIGZAG,BACKSET,PEAK,PEAKBARS,","TROUGH,TROUGHBARS,REFX等可能会导致误差。"],"funcName":"PROFIT"},{"funcMeanLines":["设置下单的虚拟资金使用比例","用法：","SETDEALPERCENT(fPercent)表示每次按资金的fPercent（范围1~100）下单。","例子：SETDEALPERCENT(20); //每次按资金比例的%20下单","注：应该与AUTOFILTER函数同时使用"],"funcName":"SETDEALPERCENT"}],"sort":11,"title":"11.头寸函数","type":"一、 自编策略模型支持的函数"},{"lines":[{"funcMeanLines":["某合约当前均价。","用法：","AvPrice(Code)返回合约Code的当前均价，Code为某合约的合约代码","例：VAR avprice;//定义一个变量avpriceavprice=AvPrice(\"m1109\"); //price的值为合约m1109的当前均价"],"funcName":"AvPrice(Code)"},{"funcMeanLines":["某合约当前最高价。","用法：","High(Code)返回合约Code的当前最高价，Code为某合约的合约代码","例：","VAR high;//定义一个变量high","high=High(\"m1109\"); //high的值为合约m1109的当前最高价"],"funcName":"High(Code)"},{"funcMeanLines":["某合约当前最低价。","用法：","Low(Code)返回合约Code的当前最低价，Code为某合约的合约代码","例：","VAR low;//定义一个变量low","low=Low(\"m1109\"); //low的值为合约m1109的当前最低价"],"funcName":"Low(Code)"},{"funcMeanLines":["某合约的盘口数据。","用法：","Position(Code,strContent) 返回某合约某种盘口数据Code","为某合约的合约代码(字符串), strContent为所要取得内容,","可选以下内容","\"bid1\",\"bid2\",\"bid3\",\"bid4\",\"bid5\",","\"ask1\",\"ask2\",\"ask3\",\"ask4\",\"ask5\",","\"bidvol1\",\"bidvol2\",\"bidvol3\",\"bidvol4\",\"bidvol5\",","\"askvol1\",\"askvol2\",\"askvol3\",\"askvol4\",\"askvol5\",","分别表示买1-买5 卖1-卖5 买1量-买5量 卖1量-卖5量。","例：","VAR bid1;","bid1=Position(\"m1109\",\"bid1\");//bid1为豆粕1009的当前买1价"],"funcName":"Position(Code,strContent)"},{"funcMeanLines":["某合约当前价格。","用法：","Price(Code)返回合约Code的当前价格，Code为某合约的合约代码","例：","VAR price;//定义一个变量price","price=Price(\"m1109\"); //price的值为合约m1109的当前价格"],"funcName":"Price(Code)"},{"funcMeanLines":["某合约当前成交量。","用法：","Volume(Code)返回合约Code的当前成交量，Code为某合约的合约代码","例：","VAR volume;//定义一个变量volume","volume=Volume(\"m1109\"); //volume的值为合约m1109的当前成交量"],"funcName":"Volume(Code)"}],"sort":1,"title":"1.引用数据函数","type":"二、 自编下单组件支持的函数"},{"lines":[{"funcMeanLines":["判断两个时间是否是同一个周期。","用法：","SamePeriod(Code,PeriodStr,T1,T2)如果T1,T2是同一个周期返回1，","否则返回0,Code:合约的合约代码，PeriodStr可以取以下值的其中之一：","\"min1\",\"min3\",\"min5\",\"min10\",\"min15\",\"min30\",\"1hour\",\"3hour\",","\"8hour\",\"1day\",\"week\",\"month\"，T1和T2是以总秒数表示的时间","例：","IF(SamePeriod(\"m1109\",\"min10\",LastOrderTime(),Time(\"09:00:00\"))合约为m1109，周期为10分钟情况下，如果最后一次下单时间与09:00:00在同一个周期内"],"funcName":"SamePeriod(Code,PeriodStr,T1,T2)"}],"sort":2,"title":"2.逻辑判断函数","type":"二、 自编下单组件支持的函数"},{"lines":[{"funcMeanLines":["当前时间。","用法：","CurrentTime()返回当前时间","例：","VAR CurTime; ","CurTime=CurrentTime(); //定义一个变量CurTime,CurTime的值为当前时间。注意返回值是1970年1月1日至今的总秒数"],"funcName":"CurrentTime()"},{"funcMeanLines":["日期转换为字符串。","用法：","DateToStr(nSec)把整形数值表示的时间nSec转换为字符串，nSec为时间的总秒数，返回的字符串格式为：YY:MM:DD","例：","MessageOut(DateToStr(CurrentTime() ) ); //输出当前日期"],"funcName":"DateToStr(nSec)"},{"funcMeanLines":["退出程序。","用法：","Exit()退出程序。","例：Exit(); 退出程序。当组件设置为循环时，遇到Exit将停止循环，请谨慎使用。当组件未设置为循环执行时，应该使用RETURN语句退出。"],"funcName":"Exit()"},{"funcMeanLines":["数字转换为字符。","用法：","Itoa(Value)将Value转换成字符串，Value的为整形数值","例：","VAR str; str=\"数字\"+Itoa(5); //str的值为\"数字5\""],"funcName":"Itoa(Value)"},{"funcMeanLines":["输出内容。","用法：MessageOut(Content),输出Content的内容。注意：Content可以是字符串也可以是数字"],"funcName":"MessageOut(Content)"},{"funcMeanLines":["返回已注册的整形变量的值","用法：ReadGlobal(strName);返回注册的strName的值,strName为已注册的整形变量的注册名称(字符串)。如果strName未被注册过，返回0","例：","WriteGlabal(\"limit\",20);","VAR limitValue;","limitValue=ReadGlobal(\"limit\");limitValue的值为20。"],"funcName":"ReadGlobal(strName)"},{"funcMeanLines":["返回已注册的浮点型变量的值","用法：ReadGlobalF(strNameF);返回注册的strNameF的值,strNameF为已注册的浮点型变量的注册名称(字符串)，如果strNameF未被注册过，返回0.0f","例：","WriteGlabalF(\"Rate\",0.5);","VAR fRate;","fRate=ReadGlobal(Rate);fRate的值为0.5。"],"funcName":"ReadGlobalF(strNameF)"},{"funcMeanLines":["返回已注册的字符串变量的值","用法：ReadGlobalStr(NameStr);返回注册的NameStr的值,NameStr为已注册的字符串变量的注册名称。如果NameStr未被注册过，返回(空字符串)","例：","WriteGlabalStr(\"showStr\",\"上升\");","VAR str;","str=ReadGlobal(showStr);//str的值为\"上升\"。"],"funcName":"ReadGlobalStr(NameStr)"},{"funcMeanLines":["转换字符串为时间。","用法：","Time(strTime) 转换字符串strTime为时间(以总秒数表示)，strTime的格式应为HH:MM:SS，其中0<=HH<24,0<=MM<60,0<=SS<60,如果不满足此条件，返回0","例：","time:Time(\"09:15:00\")"],"funcName":"Time(strTime)"},{"funcMeanLines":["时间转换为字符串。","用法：","TimeToStr(nSec) 把整形数值表示的时间nSec转换为字符串，nSec为时间的总秒数，返回的字符串格式为：HH:MM:SS","例：","MessageOut(TimeToStr(CurrentTime())),输出当前时间"],"funcName":"TimeToStr(nSec)"},{"funcMeanLines":["注册一个整形变量。","用法：","WriteGlabal(Name,Value)。Name为整形变量的注册名称(字符串)，Value为整形变量的值","例：","WriteGlabal(\"Period\",5) 注册一个整形变量,注册名称为\"Period\"，值为5。"],"funcName":"WriteGlabal(Name,Value)"},{"funcMeanLines":["注册一个浮点形变量","用法：","WriteGlabal(NameF,ValueF)。NameF为浮点形变量的注册名称(字符串)，ValueF为浮点形变量的值","例：","WriteGlabalF(\"Rate\",0.5) 注册一个浮点形变量，注册名称为\"Rate\"，值为0.5。"],"funcName":"WriteGlabal(NameF,ValueF)"},{"funcMeanLines":["注册一个字符串变量","用法：WriteGlabalStr(NameStr,ValueStr)。NameStr为字符串变量的注册名称(字符串)，ValueStr为字符串变量的值","例：","WriteGlabalStr(\"showStr\",\"上升\") 注册一个字符串变量,注册名称为\"showStr\"，值为\"上升\"。"],"funcName":"WriteGlabalStr(NameStr,ValueStr)"}],"sort":3,"title":"3.辅助函数 ","type":"二、 自编下单组件支持的函数"},{"lines":[{"funcMeanLines":["取整形绝对值。","用法：","ABS(Value)返回Value的绝对值，Value是整形值","例：","VAR X;","X=ABS(5);//X的值为5"],"funcName":"ABS(Value)"},{"funcMeanLines":["取浮点型的绝对值。","用法：","ABSF(ValueF)返回ValueF的绝对值，ValueF是浮点值","例：","VAR X; ","X=ABSF(-1.5); //X的值为1.5"],"funcName":"ABSF(ValueF)"}],"sort":4,"title":"4.数学运算函数 ","type":"二、 自编下单组件支持的函数"},{"lines":[{"funcMeanLines":["模型某合约多头持仓。","用法：","F_BuyPosition()返回模型的多头持仓","例： ","VAR fmlBVol; ","fmlBVol=F_BuyPosition(); //定义一个变量fmlBVol，fmlBVol为模型的多头持仓。"],"funcName":"F_BuyPosition()"},{"funcMeanLines":["模型某合约空头持仓。","用法：","F_SellPosition()返回模型的空头持仓","例：","VAR fMLSVol;","fmlSVol=F_SellPosition(); 定义一个变量fmlSVol，fmlSVol为模型的空头持仓。"],"funcName":"F_SellPosition()"},{"funcMeanLines":["模型某合约多头持仓成本价。","用法：","F_BuyAvgPrice()返回模型多头持仓成本价","例：","VAR price;","price=F_BuyAvgPrice(); 定义一个变量price,price的值为值为模型多头持仓成本价"],"funcName":"F_BuyAvgPrice()"},{"funcMeanLines":["模型某合约空头持仓成本价。","用法：","F_SellAvgPrice()返回模型空头持仓成本价","例：","VAR price;","price=F_SellAvgPrice() 定义一个变量price,price的值为模型空头持仓成本价"],"funcName":"F_SellAvgPrice()"},{"funcMeanLines":["取得当前模型的合约编码。","用法：","F_DealCode()返回模型所加载K图表的合约的合约编码(字符串)","例：","VAR DealCode;","DealCode=F_DealCode(); //变量DealCode的内容为模型当前合约的合约编码."],"funcName":"F_DealCode()"},{"funcMeanLines":["取得当前模型的周期。","用法：","F_Period() 返回当前模型的周期(字符串)","例：","VAR period;","period=F_Period(); //变量period的内容为当前模型所使用的周期."],"funcName":"F_Period()"},{"funcMeanLines":["刷新当前信号。","用法：","F_FreshSig() 取一个新信号(如果模型已经发出了多个信号，取最早发出的信号，信号消失也是一种信号)返回1表示取到新信号，返回0表示失败即已经没有新信号可取。取到新信号以后可以配合 F_Sig, F_SigVol, F_SigValid, F_SigTime, F_SigPos使用","例：","IF(F_FreshSig()) //如果取得了新的信号"],"funcName":"F_FreshSig()"},{"funcMeanLines":["取当前的信号(BK、SK、BP、SP、BPK、SPK)。","用法：","F_Sig() 返回当前的信号是什么类型(BK、SK、BP、SP、BPK、SPK)例：","IF(F_Sig()==BPK && F_SigValid()==1) //如果信号是BPK 且不是信号消失状态"],"funcName":"F_Sig()"},{"funcMeanLines":["取当前信号的手数。","用法：","F_SigVol() 取当前的信号的手数, 如果当前信号是BPK(5), 则返回5.","例：","IF(F_SigVol() == VarOpi) //如果信号的仓位等于变量VarOpi"],"funcName":"F_SigVol()"},{"funcMeanLines":["当前信号是发出的，还是消失的","用法：","F_SigValid() 返回模型信号存在两种类型之一(信号发出，信号消失), 返回1表示信号发出, 返回0表示信号消失。","例：","IF(F_Sig()==BPK && F_SigValid()==1) //如果信号是BPK 且不是信号消失状态"],"funcName":"F_SigValid()"},{"funcMeanLines":["当前信号的发出时间。","用法：","F_SigTime() 返回当前信号的发出时间(以总秒数表示)，","例：","IF(SamePeriod(\"m1109\",\"min10\",LastOrderTime(),F_SigTime()) //如果取得新信号的时间与上次交易的时间是同一个周期"],"funcName":"F_SigTime()"},{"funcMeanLines":["当前信号在模型中是第几个有指令的语句。","用法：","F_SigPos() 如果当前信号是模型中第5个含信号的语句发出的，返回5","例：","IF(F_SigPos()==5) //如果当前信号是第5行发出的"],"funcName":"F_SigPos()"}],"sort":5,"title":"5.模型相关函数 ","type":"二、 自编下单组件支持的函数"},{"lines":[{"funcMeanLines":["最后一次下单的时间。","用法：","LastOrderTime()返回最后一次下单的时间，以总秒数表示","例：","IF(LastOrderTime() - CurrentTime() >= 300)如果距离上次下单时间超过5分钟"],"funcName":"LastOrderTime()"},{"funcMeanLines":["交易系统某合约多头持仓。","用法：","T_BuyPosition(Code)返回交易系统中合约Code的多头持仓,Code为某合约的合约代码。","例：","VAR BuyVol;","BuyVol=T_BuyPosition(\"m1109\"); //BuyVol为交易系统中合约代码为m1109的合约的多头持仓。"],"funcName":"T_BuyPosition(Code)"},{"funcMeanLines":["交易系统某合约多头持仓成本价。","用法：T_BuyAvgPrice(Code)返回交易系统合约Code的多头持仓成本价,Code为某合约合约代码。","例：","VAR BuyPrice; BuyPrice=T_BuyAvgPrice(\"m1109\");// 定义一个变量BuyPrice,BuyPrice的值为交易系统合约m1109多头持仓成本价"],"funcName":"T_BuyAvgPrice(Code)"},{"funcMeanLines":["交易系统某合约的多头盈亏。","用法：","T_BuyProfitLoss(code)返回交易系统合约code的多头盈亏","例：","VAR BuyEarn;","BuyEarn=T_BuyProfitLoss(\"m1109\");// 定义一个变量BuyEarn,BuyEarn的值为交易系统合约m1109的多头盈亏"],"funcName":"T_BuyProfitLoss(code)"},{"funcMeanLines":["交易系统某合约空头持仓。","用法：","T_SellPosition(Code)返回交易系统中合约Code的空头持仓,Code为某合约的合约代码。","例：","VAR SellVol;","SellVol=T_SellPosition(\"m1109\");// SVol为交易系统中合约代码为m1109的合约的空头持仓。"],"funcName":"T_SellPosition(Code)"},{"funcMeanLines":["交易系统某合约空头持仓成本价。","用法：T_SellAvgPrice(code)返回交易系统合约code的空头持仓成本价,code为某合约合约代码。","例：","VAR SellPrice;","SellPrice=T_SellAvgPrice(\"m1109\");// 定义一个变量SellPrice,SellPrice的值为交易系统合约m1109空头持仓成本价"],"funcName":"T_SellAvgPrice(code)"},{"funcMeanLines":["交易系统某合约的空头盈亏。","用法：","T_SellProfitLoss(code)返回交易系统合约code的空头盈亏","例：","VAR SellEarn;","SellEarn=T_SellProfitLoss(\"m1109\") 定义一个变量SellEarn,SellEarn的值为交易系统合约m1109的空头盈亏"],"funcName":"T_SellProfitLoss(code)"},{"funcMeanLines":["发出委托。","用法：","T_Deal(Code,bs,kp,vol,price),发出委托。Code(字符串):合约编码，bs(整数0，1):0 买 1 卖 ，kp(整数0，1，2):0 开 1平 2平今 Vol(整数)：下单手数，Price(整数或小数):下单价格，0为市价 返回唯一委托标识OrderID(字符串)","例：","VAR orderID=T_Deal(\"m1109\", 0, 0, 5, 2900); 发出委托：m1109 买开5手 限价2900"],"funcName":"T_Deal(Code,bs,kp,vol,price)"},{"funcMeanLines":["可用资金。","用法T_FreeMargin(Type), 返回可用资金。　Type(整数 0, 1) 0期货 1股票，返回可用资金数(小数)","例：","VAR margin;","margin=T_FreeMargin(0); //返回当前期货帐户的可用资金数"],"funcName":"T_FreeMargin(Type)"},{"funcMeanLines":["权益。","用法T_Equity(Type), 返回权益。　Type(整数 0, 1) 0期货 1股票，返回权益(小数)","例：","VAR margin;","margin=T_Equity(0); //返回当前期货帐户的权益数"],"funcName":"T_Equity(Type)"},{"funcMeanLines":["某品种最大可开仓手数。、","用法：","T_MaxOpen(Code, margin, bs),某品种最大可开仓手数。Code(字符串):合约编码，margin(小数)：保证金比例　bs(整数0,1):0 买 1 卖　返回该品种在当前可用资金，当前价格下的可开仓手数(整数)","例：","VAR vol;","vol=T_MaxOpen(\"m1109\", 0.1, 0); //变量vol为m1109 的　在保证金比例为0.1 下的可开仓手数"],"funcName":"T_MaxOpen(Code, margin, bs)"},{"funcMeanLines":["查询委托状态。","用法：","T_OrderState(OrderID)根据委托唯一标识OrderID(字符串)查委托状态,返回值含义：-1查询失败 0挂单　1成交 2被撤单　3部份成交 4 其它","例：","IF(T_OrderState(X)=0) 如果委托X是挂单"],"funcName":"T_OrderState(OrderID)"},{"funcMeanLines":["查询挂单数量。","用法：","T_OpenOrder(Code,Type)返回未成交委托数量,Code:交易编码,Type:0所有方向;1买开;2卖平;3卖开;4买平","例：","IF(LastOrderTime() - CurrentTime >= 300 && T_OpenOrder(ru1009,1)>0) ","T_OpenOrder(\"ru1009\",1) //如果距离上次下单超过5分钟，且存在买开挂单,撤掉剩余买开委托合约X的未成交委托数量"],"funcName":"T_OpenOrder(Code,Type)"},{"funcMeanLines":["委托撤单。","用法：","T_DeleteOrder(OrderID)根据委托唯一标识orderID(字符串)撤单，返回0撤单发出成功，返回其它失败","例：","IF(T_DeleteOrder(orderID)!=0)如果撤单失败"],"funcName":"T_DeleteOrder(OrderID)"},{"funcMeanLines":["委托撤单(通过合约代码)。","用法：","T_DeleteOrderByCode(Code,Type)委托撤单。Code:合约代码(字符串)Type:0所有方向;1买开;2卖平;3卖开;4买平 返回0撤单发出成功，返回其它失败","例：","T_DeleteOrderByCode(\"ru1009\",2)撤单橡胶1009的卖平委托"],"funcName":"T_DeleteOrderByCode(Code,Type)"},{"funcMeanLines":["撤掉所有未成交委托。","用法：","T_DeleteOrderAll()撤掉所有该模型相关的未成缴委托单，返回0撤单发出成功，返回其它失败","例：","IF(T_DeleteOrderAll()!=0)//如果撤单失败"],"funcName":"T_DeleteOrderAll()"},{"funcMeanLines":["根据当前成交的量采用买开的手段达到把仓位增加某一数值的目的。","用法：","T_AddBuyOpiTo(Code, Price, Vol)把多头仓位增加到某一数值。Code(字符串):合约代码,Price(小数):价格,Vol(整数):成交量 对合约代码为Code的字符串以Price价格下单达到多头vol手持仓","例：","T_AddBuyOpiTo(\"m1109\", Price(\"m1109\")+5, 10); //买开使多头持仓达到10手"],"funcName":"T_AddBuyOpiTo(Code, Price, Vol)"},{"funcMeanLines":["根据当前成交的量采用卖开的手段达到把仓位增加到指定值的目的。","用法：","T_AddSellOpiTo(Code, Price, Vol)把空头仓位增加到某一数值。Code(字符串):合约代码,Price(小数):价格,Vol(整数):成交量 对合约代码为Code的字符串以Price价格下单达到多头vol手持仓","例：","T_AddSellOpiTo(\"m1109\", Price(\"m1109\")-5, 10); //卖开使空头持仓达到10手"],"funcName":"T_AddSellOpiTo(Code, Price, Vol)"},{"funcMeanLines":["根据当前成交的量采用卖平的手段达到把仓位减少到某一数值的目的。","用法：","T_ReduceBuyOpiTo(Code, Price, Vol)把多头仓位减少到某一数值。Code(字符串):合约代码,Price(小数):价格,Vol(整数):成交量 对合约代码为Code的字符串以Price价格下单达到多头vol手持仓","例：","T_ReduceBuyOpiTo(\"m1109\", Price(\"m1109\")-5, 10); //卖平使多头持仓减少到10手"],"funcName":"T_ReduceBuyOpiTo(Code, Price, Vol)"},{"funcMeanLines":["根据当前成交的量采用买平的手段达到把仓位减少到某一数值的目的。","用法：","T_ReduceSellOpiTo(Code, Price, Vol)把空头仓位减少到某一数值。Code(字符串):合约代码,Price(小数):价格,Vol(整数):成交量 对合约代码为Code的字符串以Price价格下单达到空头vol手持仓","例：","T_ReduceSellOpiTo(\"m1109\", Price(\"m1109\")-5, 10); //卖开使空头持仓减少到10手"],"funcName":"T_ReduceSellOpiTo(Code, Price, Vol)"},{"funcMeanLines":["当前算法交易模型产生的某品种的多头持仓。","用法：","T_StgBuyVol(Code)返回当前算法交易模型产生的合约代码为Code的合约的多头持仓数。Code(字符串):合约代码","例：","T_StgBuyVol(\"m1109\"); //当前算法交易模型产生的某品种多头持仓数"],"funcName":"T_StgBuyVol(Code)"},{"funcMeanLines":["当前算法交易模型产生产生的某品种的空头持仓。","用法：","T_StgSellVol(Code)返回当前算法交易模型产生的合约代码为Code的合约的空头持仓数。Code(字符串):合约代码","例：","T_StgSellVol(\"m1109\"); //当前算法交易模型产生的某品种空头持仓数"],"funcName":"T_StgSellVol(Code)"},{"funcMeanLines":["某次委托已经成交的数量。","用法：","T_OrderMatchVol(OrderID)根据委托唯一标识OrderID查询委托成交手数,返回成交手数。OrderID(字符串)","例：","VAR matchvol;","matchvol=T_OrderMatchVol(X); //matchvol为某次委托的已成交数量"],"funcName":"T_OrderMatchVol(OrderID)"},{"funcMeanLines":["该算法交易模型无挂单(发出的所有委托都已经成交，或被撤单)。","用法：","T_IsNoOrder()如果没有挂单返回1，否则返回0","例： ","IF(T_IsNoOrder()) //如果没有挂单"],"funcName":"T_IsNoOrder()"}],"sort":6,"title":"6.头寸函数 ","type":"二、 自编下单组件支持的函数"}]
```